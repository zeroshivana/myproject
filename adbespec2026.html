<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Adobe CC 2026 採購規格輔助系統</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-main: #f8fafc;
      --bg-card: #ffffff;
      --border: #e2e8f0;
      --text-main: #0f172a;
      --text-sub: #64748b;
      --accent-indigo: #4f46e5;
      --accent-emerald: #059669;
      --accent-amber: #d97706;
      --accent-slate: #334155;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
    }
    .app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .mobile-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1rem;
      background: #ffffff;
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 30;
    }
    .mobile-header-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #dc2626;
      font-weight: 800;
      font-size: 1.1rem;
    }
    .sidebar {
      position: fixed;
      inset: 0 auto 0 0;
      width: 280px;
      background: #ffffff;
      border-right: 1px solid var(--border);
      z-index: 40;
      transform: translateX(-100%);
      transition: transform 0.2s ease;
      display: flex;
      flex-direction: column;
    }
    .sidebar.open {
      transform: translateX(0);
      box-shadow: 0 0 20px rgba(15, 23, 42, 0.2);
    }
    .sidebar-inner {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      height: 100%;
    }
    .sidebar-header-desktop {
      display: none;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #e5e7eb;
    }
    .sidebar-group-title {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #94a3b8;
      font-weight: 700;
      margin-bottom: 0.25rem;
      padding: 0 0.25rem;
    }
    .lic-list {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    .lic-btn {
      border: none;
      border-radius: 0.5rem;
      padding: 0.5rem 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      text-align: left;
      background: transparent;
      color: var(--text-sub);
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.15s ease, box-shadow 0.15s ease, color 0.15s ease;
    }
    .lic-btn-icon {
      width: 24px;
      height: 24px;
      border-radius: 0.35rem;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .lic-btn svg {
      width: 16px;
      height: 16px;
      stroke-width: 1.8;
    }
    .lic-btn.active {
      background: #eff6ff;
      color: #1d4ed8;
      box-shadow: 0 1px 4px rgba(15, 23, 42, 0.12);
    }
    .lic-btn.active .lic-btn-icon {
      background: #ffffff;
    }
    .sidebar-close-wrap {
      display: flex;
      justify-content: flex-end;
      padding-bottom: 0.5rem;
    }
    .sidebar-close-btn {
      border: none;
      background: transparent;
      cursor: pointer;
      color: #9ca3af;
    }
    .sidebar-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.5);
      z-index: 35;
      display: none;
    }
    .sidebar-overlay.show {
      display: block;
    }
    .main {
      padding: 1rem;
      flex: 1;
    }
    .main-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding-bottom: 2rem;
    }
    .main-header {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .main-header-top {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    .main-title {
      font-size: 1.35rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .main-subtitle {
      font-size: 0.85rem;
      color: var(--text-sub);
    }
    .main-controls {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .tender-toggle {
      display: flex;
      gap: 0.25rem;
      padding: 0.25rem;
      background: #e5e7eb;
      border-radius: 0.75rem;
      border: 1px solid #cbd5e1;
      overflow-x: auto;
    }
    .tender-btn {
      border-radius: 0.5rem;
      border: none;
      background: transparent;
      padding: 0.4rem 0.75rem;
      font-size: 0.75rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.35rem;
      cursor: pointer;
      white-space: nowrap;
      color: var(--text-sub);
    }
    .tender-btn svg {
      width: 14px;
      height: 14px;
    }
    .tender-btn.active.flagship {
      background: #ffffff;
      color: var(--accent-indigo);
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.15);
    }
    .tender-btn.active.essential {
      background: #ffffff;
      color: var(--accent-emerald);
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.15);
    }
    .tender-btn.active.substance {
      background: #ffffff;
      color: var(--accent-amber);
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.15);
    }
    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .btn {
      border-radius: 0.5rem;
      padding: 0.5rem 0.75rem;
      font-size: 0.85rem;
      font-weight: 600;
      border: 1px solid #cbd5e1;
      background: #ffffff;
      color: var(--text-sub);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.35rem;
      box-shadow: 0 1px 2px rgba(15, 23, 42, 0.06);
    }
    .btn svg {
      width: 16px;
      height: 16px;
    }
    .btn-primary {
      background: #020617;
      color: #ffffff;
      border-color: #020617;
    }
    .btn-primary.copied {
      background: #166534;
    }
    .btn-audit-on {
      background: #fef3c7;
      border-color: #facc15;
      color: #92400e;
    }
    .summary-banner {
      border-radius: 0.9rem;
      padding: 1.25rem;
      color: #ffffff;
      position: relative;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.35);
      overflow: hidden;
    }
    .summary-banner.flagship {
      background: linear-gradient(90deg, #4c1d95, #4338ca);
    }
    .summary-banner.essential {
      background: linear-gradient(90deg, #047857, #0f766e);
    }
    .summary-banner.substance {
      background: linear-gradient(90deg, #ea580c, #d97706);
    }
    .summary-banner-icon-bg {
      position: absolute;
      top: -10px;
      right: -10px;
      opacity: 0.12;
    }
    .summary-banner-title {
      font-size: 1rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }
    .summary-banner-advisory {
      display: flex;
      gap: 0.75rem;
      border-radius: 0.75rem;
      padding: 0.75rem;
      background: rgba(15, 23, 42, 0.3);
      border: 1px solid rgba(248, 250, 252, 0.35);
      margin-bottom: 0.75rem;
    }
    .summary-banner-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.75rem;
    }
    @media (min-width: 768px) {
      .summary-banner-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }
    .summary-banner-card {
      background: rgba(15, 23, 42, 0.35);
      border-radius: 0.6rem;
      padding: 0.75rem;
      border: 1px solid rgba(248, 250, 252, 0.35);
    }
    .summary-banner-card-label {
      font-size: 0.7rem;
      color: rgba(241, 245, 249, 0.8);
      display: flex;
      align-items: center;
      gap: 0.25rem;
      margin-bottom: 0.2rem;
    }
    .summary-banner-card-value {
      font-size: 0.98rem;
      font-weight: 700;
    }
    .summary-banner-card-sub {
      font-size: 0.65rem;
      color: rgba(241, 245, 249, 0.7);
    }
    .tables-wrap {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .table-card {
      background: var(--bg-card);
      border-radius: 0.9rem;
      border: 1px solid var(--border);
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.08);
    }
    .table-card-header {
      padding: 0.6rem 0.9rem;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
      font-size: 0.9rem;
      background: #f8fafc;
    }
    .table-card-header svg {
      width: 18px;
      height: 18px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    thead {
      background: #f8fafc;
      color: #6b7280;
      font-size: 0.7rem;
      text-transform: uppercase;
    }
    th, td {
      padding: 0.65rem 0.9rem;
      border-bottom: 1px solid #f1f5f9;
      vertical-align: top;
    }
    tbody tr:hover {
      background: #f8fafc;
    }
    .app-name-btn {
      border: none;
      background: transparent;
      padding: 0;
      text-align: left;
      width: 100%;
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      cursor: pointer;
    }
    .app-icon-badge {
      width: 28px;
      height: 28px;
      border-radius: 0.5rem;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    .app-icon-badge svg {
      width: 18px;
      height: 18px;
    }
    .app-name-main {
      font-weight: 700;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    .app-chip-eol {
      padding: 0.1rem 0.25rem;
      border-radius: 999px;
      background: #e5e7eb;
      color: #4b5563;
      text-transform: uppercase;
      font-size: 0.6rem;
    }
    .app-version {
      font-size: 0.7rem;
      color: #9ca3af;
      margin-top: 0.15rem;
    }
    .app-platform-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.2rem;
      margin-top: 0.15rem;
    }
    .platform-badge {
      font-size: 0.62rem;
      font-weight: 700;
      padding: 0.1rem 0.35rem;
      border-radius: 999px;
      border: 1px solid;
    }
    .platform-badge.web {
      background: #e0f2fe;
      border-color: #bfdbfe;
      color: #0369a1;
    }
    .platform-badge.ios {
      background: #e0e7ff;
      border-color: #c7d2fe;
      color: #4f46e5;
    }
    .platform-badge.android {
      background: #dcfce7;
      border-color: #bbf7d0;
      color: #15803d;
    }
    .app-dimmed {
      opacity: 0.45;
      filter: grayscale(0.35);
    }
    .app-alert-pill {
      margin-top: 0.25rem;
      font-size: 0.65rem;
      font-weight: 700;
      padding: 0.1rem 0.35rem;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 0.2rem;
    }
    .app-alert-pill svg {
      width: 11px;
      height: 11px;
    }
    .app-alert-eol {
      background: #fee2e2;
      color: #b91c1c;
    }
    .app-alert-normal {
      background: #fef3c7;
      color: #b45309;
    }
    .audit-col {
      background: #fffbeb;
      border-left: 1px solid #fed7aa;
      min-width: 130px;
    }
    .audit-link {
      font-size: 0.75rem;
      color: #2563eb;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.2rem;
      margin-bottom: 0.25rem;
    }
    .audit-link svg {
      width: 12px;
      height: 12px;
    }
    .audit-checkbox-label {
      font-size: 0.75rem;
      color: #6b7280;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
    .restricted-note {
      background: #e5e7eb;
      border-radius: 0.9rem;
      border: 1px solid #cbd5e1;
      padding: 1.25rem;
      text-align: center;
      color: #6b7280;
      font-size: 0.85rem;
    }
    .restricted-note svg {
      width: 32px;
      height: 32px;
      margin-bottom: 0.25rem;
      color: #9ca3af;
    }
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .modal-backdrop.show {
      display: flex;
    }
    .modal {
      background: #ffffff;
      border-radius: 1rem;
      padding: 1.25rem;
      max-width: 360px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.35);
      position: relative;
      border: 1px solid #e2e8f0;
    }
    .modal-close {
      position: absolute;
      right: 0.75rem;
      top: 0.75rem;
      border: none;
      background: transparent;
      cursor: pointer;
      color: #9ca3af;
    }
    .modal-icon {
      margin-bottom: 0.75rem;
      width: 64px;
      height: 64px;
      border-radius: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-icon.desktop {
      background: #eff6ff;
      color: #2563eb;
    }
    .modal-icon.substance {
      background: #eef2ff;
      color: #4f46e5;
    }
    .modal-icon.cloud {
      background: #f5f3ff;
      color: #7c3aed;
    }
    .modal-icon.eol {
      background: #e5e7eb;
      color: #4b5563;
    }
    .modal-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 0.15rem;
      text-align: center;
    }
    .modal-subtitle {
      font-size: 0.75rem;
      color: #6b7280;
      margin-bottom: 0.5rem;
      text-align: center;
    }
    .modal-body {
      background: #f1f5f9;
      border-radius: 0.75rem;
      padding: 0.75rem;
      font-size: 0.82rem;
      color: #4b5563;
      margin-bottom: 0.75rem;
    }
    .modal-link-btn {
      border-radius: 0.75rem;
      border: none;
      background: #020617;
      color: #ffffff;
      font-weight: 700;
      font-size: 0.85rem;
      padding: 0.6rem 0.75rem;
      width: 100%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
    }
    .modal-link-btn svg {
      width: 14px;
      height: 14px;
    }

    @media (min-width: 1024px) {
      .app {
        flex-direction: row;
      }
      .mobile-header {
        display: none;
      }
      .sidebar {
        position: static;
        transform: none !important;
        width: 280px;
      }
      .sidebar-overlay {
        display: none !important;
      }
      .sidebar-header-desktop {
        display: block;
      }
      .sidebar-close-wrap {
        display: none;
      }
      .main {
        margin-left: 280px;
        width: calc(100% - 280px);
        padding: 1.5rem 2rem;
        max-height: 100vh;
        overflow-y: auto;
      }
      .main-header {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
      .main-controls {
        flex-direction: row;
        align-items: center;
        justify-content: flex-end;
      }
      .tender-toggle {
        width: auto;
      }
    }
  </style>

  <!-- SVG symbol sprite (簡化版圖示) -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none;">
    <!-- 基本圖示 -->
    <symbol id="icon-globe" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="2" y1="12" x2="22" y2="12"></line>
      <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
    </symbol>
    <symbol id="icon-monitor" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="4" width="18" height="14" rx="2"></rect>
      <line x1="8" y1="20" x2="16" y2="20"></line>
      <line x1="12" y1="18" x2="12" y2="20"></line>
    </symbol>
    <symbol id="icon-cpu" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="4" y="4" width="16" height="16" rx="2"></rect>
      <rect x="9" y="9" width="6" height="6"></rect>
      <path d="M9 1v3M15 1v3M9 20v3M15 20v3M1 9h3M1 15h3M20 9h3M20 15h3"></path>
    </symbol>
    <symbol id="icon-hard-drive" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="7" width="18" height="10" rx="2"></rect>
      <circle cx="7" cy="12" r="1"></circle>
      <circle cx="11" cy="12" r="1"></circle>
      <line x1="15" y1="12" x2="18" y2="12"></line>
    </symbol>
    <symbol id="icon-layers" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="m12 2 9 5-9 5-9-5 9-5z"></path>
      <path d="m3 12 9 5 9-5"></path>
      <path d="m3 17 9 5 9-5"></path>
    </symbol>
    <symbol id="icon-video" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="5" width="13" height="14" rx="2"></rect>
      <path d="m16 9 5-3v12l-5-3z"></path>
    </symbol>
    <symbol id="icon-image" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="4" width="18" height="16" rx="2"></rect>
      <circle cx="8.5" cy="9.5" r="1.5"></circle>
      <path d="m21 15-3.5-3.5a2.1 2.1 0 0 0-3 0L9 18"></path>
    </symbol>
    <symbol id="icon-file-text" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M6 2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"></path>
      <path d="M14 2v5h5"></path>
      <path d="M8 13h8M8 17h5"></path>
    </symbol>
    <symbol id="icon-check-circle" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10"></circle>
      <path d="m9 12 2 2 4-4"></path>
    </symbol>
    <symbol id="icon-copy" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="9" y="9" width="13" height="13" rx="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </symbol>
    <symbol id="icon-alert-triangle" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
      <line x1="12" y1="9" x2="12" y2="13"></line>
      <line x1="12" y1="17" x2="12.01" y2="17"></line>
    </symbol>
    <symbol id="icon-pen-tool" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="m12 19 4-9-4-2-4 2 4 9Z"></path>
      <path d="M8 7h8"></path>
      <path d="M5 3h4v4H5V3Z"></path>
      <path d="M15 3h4v4h-4V3Z"></path>
      <path d="M3 11v-1h2"></path>
      <path d="M19 10h2v1"></path>
    </symbol>
    <symbol id="icon-grid" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="3" width="7" height="7"></rect>
      <rect x="14" y="3" width="7" height="7"></rect>
      <rect x="14" y="14" width="7" height="7"></rect>
      <rect x="3" y="14" width="7" height="7"></rect>
    </symbol>
    <symbol id="icon-school" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M22 9 12 5 2 9l10 4 10-4z"></path>
      <path d="M6 10.6V16L12 19l6-3v-5.4"></path>
    </symbol>
    <symbol id="icon-building-2" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M3 21h18"></path>
      <path d="M4 21V9a2 2 0 0 1 2-2h4"></path>
      <path d="M20 21V7a2 2 0 0 0-2-2h-4"></path>
      <path d="M9 17v-2"></path>
      <path d="M9 13v-2"></path>
      <path d="M15 17v-2"></path>
      <path d="M15 13v-2"></path>
    </symbol>
    <symbol id="icon-shield-alert" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
      <path d="M12 8v4"></path>
      <circle cx="12" cy="16" r="1"></circle>
    </symbol>
    <symbol id="icon-users" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
      <circle cx="9" cy="7" r="4"></circle>
      <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
      <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
    </symbol>
    <symbol id="icon-user" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="7" r="4"></circle>
      <path d="M5.5 21a6.5 6.5 0 0 1 13 0"></path>
    </symbol>
    <symbol id="icon-clapperboard" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="2" y="7" width="20" height="15" rx="2"></rect>
      <path d="M2 7h20"></path>
      <path d="m6 2 3 5"></path>
      <path d="m11 2 3 5"></path>
      <path d="m16 2 3 5"></path>
    </symbol>
    <symbol id="icon-code" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="m16 18 6-6-6-6"></path>
      <path d="m8 6-6 6 6 6"></path>
    </symbol>
    <symbol id="icon-brush" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M9.5 6.5 4 12l4 4 5.5-5.5"></path>
      <path d="M15 5 19 1l4 4-4 4"></path>
      <path d="M4 20h7"></path>
    </symbol>
    <symbol id="icon-mic" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="9" y="2" width="6" height="11" rx="3"></rect>
      <path d="M5 10a7 7 0 0 0 14 0"></path>
      <path d="M12 19v3"></path>
      <path d="M8 22h8"></path>
    </symbol>
    <symbol id="icon-info" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="16" x2="12" y2="12"></line>
      <line x1="12" y1="8" x2="12.01" y2="8"></line>
    </symbol>
    <symbol id="icon-chevron-right" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <polyline points="9 18 15 12 9 6"></polyline>
    </symbol>
    <symbol id="icon-cloud-off" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="m2 2 20 20"></path>
      <path d="M7 16a4 4 0 0 1-.88-7.9 5 5 0 0 1 9.8-1.3"></path>
      <path d="M17.5 17H9"></path>
    </symbol>
    <symbol id="icon-cloud" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M17.5 19a4.5 4.5 0 0 0 .5-9 6 6 0 0 0-11.31-1A4 4 0 0 0 7 19Z"></path>
    </symbol>
    <symbol id="icon-sparkles" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M12 3 10 8 5 10l5 2 2 5 2-5 5-2-5-2-2-5Z"></path>
      <path d="M5 3v4"></path>
      <path d="M19 17v4"></path>
    </symbol>
    <symbol id="icon-layout" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="3" width="18" height="18" rx="2"></rect>
      <path d="M12 3v18"></path>
      <path d="M3 9h9"></path>
    </symbol>
    <symbol id="icon-tablet" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="5" y="2" width="14" height="20" rx="2"></rect>
      <line x1="12" y1="18" x2="12.01" y2="18"></line>
    </symbol>
    <symbol id="icon-external-link" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M15 3h6v6"></path>
      <path d="M10 14 21 3"></path>
      <path d="M5 5v16h16"></path>
    </symbol>
    <symbol id="icon-zap" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M13 2 3 14h9l-1 8 10-12h-9z"></path>
    </symbol>
    <symbol id="icon-settings" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="3"></circle>
      <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82L4.21 5.1a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
    </symbol>
    <symbol id="icon-type" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <polyline points="4 7 4 4 20 4 20 7"></polyline>
      <line x1="9" y1="20" x2="15" y2="20"></line>
      <line x1="12" y1="4" x2="12" y2="20"></line>
    </symbol>
    <symbol id="icon-clipboard-check" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="8" y="3" width="8" height="4" rx="1"></rect>
      <path d="M9 3h6"></path>
      <path d="M9 21H5a2 2 0 0 1-2-2V8"></path>
      <path d="M15 21h4a2 2 0 0 0 2-2V8"></path>
      <path d="m9 12 2 2 4-4"></path>
    </symbol>
    <symbol id="icon-eye" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M2 12s3.6-7 10-7 10 7 10 7-3.6 7-10 7S2 12 2 12z"></path>
      <circle cx="12" cy="12" r="3"></circle>
    </symbol>
    <symbol id="icon-calendar-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="3" y="4" width="18" height="18" rx="2"></rect>
      <path d="M16 2v4"></path>
      <path d="M8 2v4"></path>
      <path d="M3 10h18"></path>
      <circle cx="16" cy="16" r="3"></circle>
      <path d="M16 14v2l1 1"></path>
    </symbol>
    <symbol id="icon-filter" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M4 4h16"></path>
      <path d="M6 8h12"></path>
      <path d="M8 12h8"></path>
      <path d="M10 16h4"></path>
    </symbol>
    <symbol id="icon-boxes" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M3 7l9-4 9 4-9 4-9-4z"></path>
      <path d="M3 17l9 4 9-4"></path>
      <path d="M3 12l9 4 9-4"></path>
    </symbol>
    <symbol id="icon-alert-octagon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M7.86 2h8.28L22 7.86v8.28L16.14 22H7.86L2 16.14V7.86L7.86 2z"></path>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </symbol>
    <symbol id="icon-x-circle" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10"></circle>
      <path d="m15 9-6 6"></path>
      <path d="m9 9 6 6"></path>
    </symbol>
    <symbol id="icon-box" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M21 16V8a2 2 0 0 0-1-1.73L13 3.18a2 2 0 0 0-2 0L4 6.27A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4.09a2 2 0 0 0 2 0l7-4.09a2 2 0 0 0 1-1.73z"></path>
      <path d="M3.3 7.3 12 12l8.7-4.7"></path>
      <path d="M12 22V12"></path>
    </symbol>
    <symbol id="icon-camera" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M4 7h3l2-3h6l2 3h3v12H4z"></path>
      <circle cx="12" cy="13" r="4"></circle>
    </symbol>
    <symbol id="icon-download" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
      <path d="M7 10l5 5 5-5"></path>
      <path d="M12 15V3"></path>
    </symbol>
    <symbol id="icon-smartphone" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <rect x="7" y="2" width="10" height="20" rx="2"></rect>
      <line x1="12" y1="18" x2="12.01" y2="18"></line>
    </symbol>
    <symbol id="icon-palette" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M12 3a9 9 0 0 0-9 9 7 7 0 0 0 7 7h1a2 2 0 0 0 2-2 1 1 0 0 1 1-1h1a4 4 0 0 0 4-4 9 9 0 0 0-9-9z"></path>
      <circle cx="8.5" cy="10.5" r="1"></circle>
      <circle cx="12" cy="7.5" r="1"></circle>
      <circle cx="15.5" cy="10.5" r="1"></circle>
      <circle cx="11" cy="14" r="1"></circle>
    </symbol>
    <symbol id="icon-x" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <path d="M18 6 6 18"></path>
      <path d="m6 6 12 12"></path>
    </symbol>
    <symbol id="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <line x1="4" y1="6" x2="20" y2="6"></line>
      <line x1="4" y1="12" x2="20" y2="12"></line>
      <line x1="4" y1="18" x2="20" y2="18"></line>
    </symbol>
  </svg>
</head>
<body>
<div class="app">
  <!-- Mobile Header -->
  <header class="mobile-header">
    <div class="mobile-header-title">
      <svg class="icon"><use href="#icon-globe"></use></svg>
      <span>ADOBE SPEC</span>
    </div>
    <button id="mobile-menu-toggle" class="btn" style="padding:0.3rem 0.4rem;border-radius:0.5rem;">
      <svg><use href="#icon-menu"></use></svg>
    </button>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-inner">
      <div class="sidebar-header-desktop">
        <div class="mobile-header-title">
          <svg class="icon"><use href="#icon-globe"></use></svg>
          <span>ADOBE SPEC <span style="color:#9ca3af;font-weight:400;font-size:0.75rem;">2026 RWD</span></span>
        </div>
        <div style="font-size:0.65rem;color:#9ca3af;margin-top:0.2rem;">政府/教育 採購規格輔助系統</div>
      </div>

      <div class="sidebar-close-wrap">
        <button class="sidebar-close-btn" id="sidebar-close">
          <svg><use href="#icon-x"></use></svg>
        </button>
      </div>

      <div>
        <div class="sidebar-group-title">商業與政府</div>
        <div id="comm-gov-list" class="lic-list"></div>
      </div>

      <div>
        <div class="sidebar-group-title">教育單位 (Education)</div>
        <div id="edu-list" class="lic-list"></div>
      </div>
    </div>
  </aside>

  <div class="sidebar-overlay" id="sidebar-overlay"></div>

  <!-- Main Content -->
  <main class="main">
    <div class="main-inner">
      <section class="main-header">
        <div class="main-header-top">
          <h1 id="lic-title" class="main-title"></h1>
          <p id="lic-subtitle" class="main-subtitle"></p>
        </div>
        <div class="main-controls">
          <div class="tender-toggle" id="tender-toggle">
            <button class="tender-btn" data-level="flagship">
              <svg><use href="#icon-clapperboard"></use></svg>
              <span>全套旗艦</span>
            </button>
            <button class="tender-btn" data-level="essential">
              <svg><use href="#icon-pen-tool"></use></svg>
              <span>基礎平面</span>
            </button>
            <button class="tender-btn" data-level="substance">
              <svg><use href="#icon-box"></use></svg>
              <span>Substance 專用</span>
            </button>
          </div>

          <div class="action-buttons">
            <button class="btn" id="audit-toggle">
              <svg><use href="#icon-clipboard-check"></use></svg>
              <span class="audit-text">資料稽核</span>
            </button>
            <button class="btn btn-primary" id="copy-btn">
              <svg><use href="#icon-copy"></use></svg>
              <span>複製當下規格</span>
            </button>
            <button class="btn" id="download-btn" title="下載規格文字檔">
              <svg><use href="#icon-download"></use></svg>
            </button>
          </div>
        </div>
      </section>

      <section id="summary-banner"></section>

      <section class="tables-wrap" id="tables"></section>

      <section id="restricted-note-wrap"></section>
    </div>
  </main>

  <!-- Modal -->
  <div class="modal-backdrop" id="modal-backdrop">
    <div class="modal">
      <button class="modal-close" id="modal-close">
        <svg><use href="#icon-x"></use></svg>
      </button>
      <div id="modal-icon" class="modal-icon desktop">
        <svg><use href="#icon-image"></use></svg>
      </div>
      <h3 id="modal-title" class="modal-title"></h3>
      <div id="modal-subtitle" class="modal-subtitle"></div>
      <div id="modal-body" class="modal-body"></div>
      <button id="modal-link" class="modal-link-btn">
        <span>前往官方規格頁</span>
        <svg><use href="#icon-external-link"></use></svg>
      </button>
    </div>
  </div>
</div>

<script>
  // ====== Data ======
  const adobeApps = [
    // Desktop
    {
      id: 'ps', name: 'Photoshop', category: 'desktop', icon: 'image', version: '2026 (v27)', desc: '影像編輯',
      intro: '全球標準的影像合成與編輯軟體，支援 AI 生成填色與進階修圖功能。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB+', rec_gpu: '4GB VRAM', level: 60, is_heavy: false, is_video: false,
      alert: '建議 macOS 14 最佳',
      url: 'https://helpx.adobe.com/tw/photoshop/system-requirements.html'
    },
    {
      id: 'ai', name: 'Illustrator', category: 'desktop', icon: 'pen-tool', version: '2026 (v30)', desc: '向量繪圖',
      intro: '向量圖形設計標準工具，適用於標誌、圖示、插畫與包裝設計。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB+', rec_gpu: '4GB VRAM', level: 50, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/illustrator/system-requirements.html'
    },
    {
      id: 'id', name: 'InDesign', category: 'desktop', icon: 'file-text', version: '2026 (v21)', desc: '排版設計',
      intro: '專業版面設計與排版軟體，適用於雜誌、書籍、數位出版與互動文件。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/indesign/system-requirements.html'
    },
    {
      id: 'ic', name: 'InCopy', category: 'desktop', icon: 'type', version: '2026 (v21)', desc: '文稿編輯',
      intro: '與 InDesign 協作的文稿撰寫工具，讓編輯與設計師能同時處理同一份文件。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 30, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/incopy/system-requirements.html'
    },
    {
      id: 'ac', name: 'Acrobat Pro', category: 'desktop', icon: 'file-text', version: 'DC (Continuous)', desc: 'PDF文件',
      intro: '最完整的 PDF 解決方案，支援建立、編輯、簽署與保護 PDF 文件。',
      min_os_win: 'Win 10 (1809)', min_os_mac: 'macOS 12',
      rec_ram: '8GB', rec_gpu: '選用', level: 10, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/acrobat/system-requirements.html'
    },
    {
      id: 'lrc', name: 'Lightroom Classic', category: 'desktop', icon: 'image', version: '2026 (v15)', desc: '相片管理',
      intro: '專為攝影師設計的桌面端相片管理與修圖軟體，提供強大的批次處理功能。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB+', rec_gpu: '8GB VRAM', level: 60, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/lightroom-classic/system-requirements.html'
    },
    {
      id: 'pr', name: 'Premiere Pro', category: 'desktop', icon: 'video', version: '2026 (v26)', desc: '影片剪輯',
      intro: '業界標準的專業影片剪輯軟體，支援從 8K 到虛擬實境的各種格式。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '32GB (4K)', rec_gpu: '6GB+ VRAM', level: 85, is_heavy: true, is_video: true,
      alert: '介面僅支援簡體中文 / CPU需支援 AVX2',
      url: 'https://helpx.adobe.com/cn/premiere-pro/system-requirements.html'
    },
    {
      id: 'ae', name: 'After Effects', category: 'desktop', icon: 'layers', version: '2026 (v26)', desc: '特效合成',
      intro: '電影級視覺特效與動態圖形合成軟體，廣泛用於電影、電視與網頁影片。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '32GB / 64GB', rec_gpu: '8GB+ VRAM', level: 100, is_heavy: true, is_video: true,
      alert: '介面僅支援簡體中文 / 4K建議 64GB RAM',
      url: 'https://helpx.adobe.com/cn/after-effects/system-requirements.html'
    },
    {
      id: 'au', name: 'Audition', category: 'desktop', icon: 'mic', version: '2026 (v26)', desc: '音訊編輯',
      intro: '專業音訊工作站，提供混音、修復與精準編輯功能，還原純淨音質。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB', rec_gpu: '2GB VRAM', level: 40, is_heavy: true, is_video: true,
      alert: '介面僅支援簡體中文',
      url: 'https://helpx.adobe.com/cn/audition/system-requirements.html'
    },
    {
      id: 'me', name: 'Media Encoder', category: 'desktop', icon: 'settings', version: '2026 (v26)', desc: '影音轉檔',
      intro: '全能影音轉檔工具，支援幾乎所有格式，可背景執行算圖任務。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: true, is_video: true,
      url: 'https://helpx.adobe.com/tw/media-encoder/system-requirements.html'
    },
    {
      id: 'ch', name: 'Character Animator', category: 'desktop', icon: 'users', version: '2026 (v26)', desc: '動畫捕捉',
      intro: '利用網路攝影機即時捕捉表情動作，讓 2D 角色瞬間活起來的動畫工具。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 12',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 50, is_heavy: true, is_video: true,
      url: 'https://helpx.adobe.com/tw/character-animator/system-requirements.html'
    },
    {
      id: 'an', name: 'Animate', category: 'desktop', icon: 'clapperboard', version: '2026 (v26)', desc: '2D動畫',
      intro: '互動式向量動畫設計工具（前身為 Flash），適用於遊戲、應用程式與網頁。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 12',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: true, is_video: false,
      alert: 'Mac 版不支援中文介面',
      url: 'https://helpx.adobe.com/tw/animate/system-requirements.html'
    },
    {
      id: 'dw', name: 'Dreamweaver', category: 'desktop', icon: 'code', version: '2021 (v21)', desc: '網頁設計',
      intro: '支援 HTML/CSS/JS 的視覺化網頁設計與程式碼編輯工具。',
      min_os_win: 'Win 10 (1903)', min_os_mac: 'macOS 11',
      rec_ram: '4GB', rec_gpu: '1GB VRAM', level: 20, is_heavy: false, is_video: false,
      alert: 'Mac 版不支援中文介面',
      url: 'https://helpx.adobe.com/tw/dreamweaver/system-requirements.html'
    },
    {
      id: 'br', name: 'Bridge', category: 'desktop', icon: 'boxes', version: '2026 (v16)', desc: '資產管理',
      intro: '強大的創意資產管理員，可預覽、整理、編輯與發佈多種創意檔案。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 20, is_heavy: false, is_video: false,
      url: 'https://helpx.adobe.com/tw/bridge/system-requirements.html'
    },
    {
      id: 'lr', name: 'Adobe Lightroom', category: 'desktop', icon: 'cloud', version: '2026', desc: '雲端相片服務',
      intro: '基於雲端的相片服務，隨時隨地編輯、整理、儲存與分享相片。',
      min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13',
      rec_ram: '8GB', rec_gpu: '2GB VRAM', level: 40, is_heavy: false, is_video: false,
      sdl_excluded: true,
      url: 'https://helpx.adobe.com/tw/lightroom-cc/system-requirements.html'
    },

    // Substance 3D
    {
      id: 'sub_pt', name: 'Substance 3D Painter', category: 'substance', icon: 'box', version: '2026', desc: '3D 材質繪製',
      intro: '3D 界的 Photoshop，可直接在 3D 模型上繪製材質與紋理。',
      min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12',
      rec_ram: '32GB', rec_gpu: '8GB+ VRAM', level: 90, is_heavy: true, is_video: false, frl_excluded: true,
      url: 'https://helpx.adobe.com/substance-3d-painter/getting-started/system-requirements.html'
    },
    {
      id: 'sub_ds', name: 'Substance 3D Designer', category: 'substance', icon: 'grid', version: '2026', desc: '3D 材質設計',
      intro: '基於節點的材質創作工具，可從無到有設計出無限變化的 3D 材質。',
      min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12',
      rec_ram: '32GB', rec_gpu: '8GB+ VRAM', level: 85, is_heavy: true, is_video: false, frl_excluded: true,
      url: 'https://helpx.adobe.com/substance-3d-designer/home.html'
    },
    {
      id: 'sub_sg', name: 'Substance 3D Stager', category: 'substance', icon: 'image', version: '2026', desc: '3D 場景佈置',
      intro: '直覺的 3D 場景佈置與算圖工具，用於建立高品質的虛擬攝影棚照。',
      min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12',
      rec_ram: '32GB', rec_gpu: '8GB+ VRAM (RTX)', level: 95, is_heavy: true, is_video: false, frl_excluded: true,
      url: 'https://helpx.adobe.com/substance-3d-stager/getting-started/system-requirements.html'
    },
    {
      id: 'sub_sp', name: 'Substance 3D Sampler', category: 'substance', icon: 'camera', version: '2026', desc: '材質取樣',
      intro: '利用 AI 技術將實物照片快速轉換為高品質 3D 材質與環境光。',
      min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12',
      rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 70, is_heavy: true, is_video: false, frl_excluded: true,
      url: 'https://helpx.adobe.com/substance-3d-sampler/getting-started/system-requirements.html'
    },
    {
      id: 'sub_md', name: 'Substance 3D Modeler', category: 'substance', icon: 'box', version: '2026', desc: 'VR/桌面建模',
      intro: '結合 VR 與桌面的直覺式 3D 建模工具，如同捏黏土般自由創作。',
      min_os_win: 'Win 10 22H2', min_os_mac: '不支援 (僅Win)',
      rec_ram: '32GB', rec_gpu: '8GB VRAM', level: 90, is_heavy: true, is_video: false, frl_excluded: true,
      alert: '僅支援 Windows (Desktop/VR)',
      url: 'https://helpx.adobe.com/substance-3d-modeler/getting-started/system-requirements.html'
    },

    // EOL / Free
    {
      id: 'ru', name: 'Premiere Rush', category: 'eol', icon: 'video', version: '2026/9 終止服務', desc: '跨裝置剪輯',
      intro: '跨裝置輕量剪輯軟體 (將於 2026 年 9 月終止服務)。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, is_video: false,
      alert: '2026年9月停止服務',
      sdl_excluded: true,
      url: 'https://helpx.adobe.com/tw/premiere-rush/system-requirements.html',
      is_eol: true
    },
    {
      id: 'xd', name: 'Adobe XD', category: 'eol', icon: 'layout', version: '維護模式', desc: 'UI/UX 設計',
      intro: 'UI/UX 設計與原型製作工具 (目前處於維護模式，不再新增功能)。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, is_video: false,
      alert: '維護模式 (不再更新)',
      sdl_excluded: true,
      url: 'https://helpx.adobe.com/tw/xd/system-requirements.html',
      is_eol: true
    },
    {
      id: 'fresco', name: 'Adobe Fresco', category: 'eol', icon: 'brush', version: '免費軟體', desc: '數位繪圖',
      intro: '專為觸控與手寫筆設計的數位繪圖軟體 (現已全面免費)。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, is_video: false,
      alert: '免費軟體 (不列入規格)',
      url: 'https://helpx.adobe.com/tw/fresco/system-requirements.html',
      is_eol: true
    },
    {
      id: 'dn', name: 'Adobe Dimension', category: 'eol', icon: 'box', version: '維護模式', desc: '3D 產品合成',
      intro: '簡易 3D 合成工具 (因應 Substance 推出，後續不會再更新)。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, is_video: false,
      alert: '維護模式 (不再更新)',
      url: 'https://helpx.adobe.com/tw/dimension/system-requirements.html',
      is_eol: true
    },

    // Cloud / Mobile / Services
    {
      id: 'firefly_mob', name: 'Adobe Firefly', category: 'cloud', icon: 'sparkles', version: 'AI 引擎', desc: '生成式 AI',
      intro: 'Adobe 的生成式 AI 引擎，可透過文字指令生成高品質影像與文字特效。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 20, is_heavy: false, is_video: false,
      has_web: true, has_ios: true, has_android: true,
      url: 'https://firefly.adobe.com/'
    },
    {
      id: 'pr_mob', name: 'Adobe Premiere App', category: 'cloud', icon: 'video', version: 'Mobile', desc: '行動剪輯',
      intro: 'Premiere Pro 的行動版延伸，提供手機上的專業剪輯功能。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 20, is_heavy: false, is_video: false,
      has_ios: true, has_android: true,
      url: 'https://www.adobe.com/tw/products/premiere-rush.html'
    },
    {
      id: 'express_mob', name: 'Adobe Express', category: 'cloud', icon: 'layout', version: 'All-in-One', desc: '快速設計',
      intro: '全能線上設計工具，整合海報製作、影片剪輯與 PDF 編輯功能。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 20, is_heavy: false, is_video: false,
      has_web: true, has_ios: true, has_android: true,
      url: 'https://www.adobe.com/tw/express/'
    },
    {
      id: 'capture', name: 'Adobe Capture', category: 'cloud', icon: 'camera', version: 'Mobile', desc: '素材擷取',
      intro: '將手機相機變成向量轉換器，隨時擷取色彩、圖案與字型素材。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_ios: true, has_android: true,
      url: 'https://www.adobe.com/tw/products/capture.html'
    },
    {
      id: 'lr_mob', name: 'Adobe Lightroom (Mobile)', category: 'cloud', icon: 'image', version: 'Multi-Platform', desc: '行動修圖',
      intro: '強大的雲端相片服務，支援跨裝置編輯、整理與分享高解析度照片。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 20, is_heavy: false, is_video: false,
      has_web: true, has_ios: true, has_android: true,
      url: 'https://www.adobe.com/tw/products/photoshop-lightroom.html'
    },
    {
      id: 'ac_mob', name: 'Adobe Acrobat Reader (Mobile)', category: 'cloud', icon: 'file-text', version: 'Multi-Platform', desc: 'PDF 閱讀',
      intro: '全球標準的 PDF 檢視器，支援在行動裝置上檢視、簽署與註解 PDF。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_web: true, has_ios: true, has_android: true,
      url: 'https://acrobat.adobe.com/tw/zh-Hant/mobile/acrobat-reader.html'
    },
    {
      id: 'behance', name: 'Behance', category: 'cloud', icon: 'globe', version: 'Service', desc: '創意社群',
      intro: '全球最大的創意作品展示平台，可建立個人作品集並發掘靈感。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_web: true, has_ios: true, has_android: true,
      url: 'https://www.behance.net/'
    },
    {
      id: 'font', name: 'Adobe Fonts', category: 'cloud', icon: 'type', version: 'Service', desc: '雲端字型',
      intro: '提供數千種高品質字型，可一鍵同步至所有 Creative Cloud 應用程式。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_web: true,
      url: 'https://fonts.adobe.com/'
    },
    {
      id: 'color', name: 'Adobe Color', category: 'cloud', icon: 'palette', version: 'Service', desc: '配色工具',
      intro: '專業配色方案產生器，可從圖片擷取色彩或探索社群創作的色票。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_web: true,
      url: 'https://color.adobe.com/'
    },
    {
      id: 'port', name: 'Adobe Portfolio', category: 'cloud', icon: 'globe', version: 'Service', desc: '作品集網站',
      intro: '快速建立個人作品集網站的工具，直接連動 Behance 與 Lightroom。',
      min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 10, is_heavy: false, is_video: false,
      has_web: true,
      url: 'https://portfolio.adobe.com/'
    }
  ];

  const licenses = [
    {
      id: 'commercial', name: '指名授權-商業', short: '商業指名', color: 'blue', icon: 'building-2',
      summaryFlagship: { cpu: 'i7/i9 (14th)', ram: '64 GB', gpu: 'RTX 4070', os: 'Win 11 / Mac 14' },
      summaryEssential: { cpu: 'i5 (13th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 11 / Mac 13' },
      type: 'full', isEdu: false, group: 'comm_gov'
    },
    {
      id: 'gov_frl', name: '離線授權-政府FRL', short: '政府 FRL', color: 'rose', icon: 'shield-alert',
      summaryFlagship: { cpu: 'Xeon W', ram: '64 GB+', gpu: 'RTX 4080', os: 'Win 11 (離線)' },
      summaryEssential: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 11 (離線)' },
      type: 'restricted', isEdu: false, group: 'comm_gov'
    },
    {
      id: 'edu_named', name: '指名授權-教育大專院校', short: '大專指名', color: 'indigo', icon: 'user',
      summaryFlagship: { cpu: 'i7 (13th)', ram: '32 GB', gpu: 'RTX 4060', os: 'Win 11 / Mac 14' },
      summaryEssential: { cpu: 'i5 (13th)', ram: '16 GB', gpu: '內顯/入門獨顯', os: 'Win 11 / Mac 13' },
      summarySubstance: { cpu: 'i7/i9', ram: '32 GB', gpu: 'RTX 3060+', os: 'Win 11 / Mac 14' },
      type: 'full', isEdu: true, group: 'edu'
    },
    {
      id: 'k12_named', name: '指名授權-教育K12', short: 'K12 指名', color: 'emerald', icon: 'user',
      summaryFlagship: { cpu: 'i5 (13th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 13' },
      summaryEssential: { cpu: 'i5 (12th)', ram: '8 GB', gpu: '內顯', os: 'Win 10 / Mac 13' },
      summarySubstance: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 10 / Mac 14' },
      type: 'full', isEdu: true, group: 'edu'
    },
    {
      id: 'edu_device', name: '裝置授權-教育大專院校 SDL', short: '大專 SDL', color: 'purple', icon: 'school',
      summaryFlagship: { cpu: 'i7 (12th)', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 10 / Mac 13' },
      summaryEssential: { cpu: 'i5 (12th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 13' },
      summarySubstance: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060+', os: 'Win 10 / Mac 14' },
      type: 'restricted', isEdu: true, group: 'edu'
    },
    {
      id: 'k12_device', name: '裝置授權-教育K12 SDL', short: 'K12 SDL', color: 'teal', icon: 'users',
      summaryFlagship: { cpu: 'i5 (12th)', ram: '16 GB', gpu: 'GTX 1650', os: 'Win 10 / Mac 13' },
      summaryEssential: { cpu: 'i5 (11th)', ram: '8 GB', gpu: '內顯', os: 'Win 10 / Mac 13' },
      summarySubstance: { cpu: 'i5/i7', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 14' },
      type: 'restricted', isEdu: true, group: 'edu'
    }
  ];

  // ====== State ======
  let activeLicId = 'commercial';
  let tenderLevel = 'flagship'; // flagship | essential | substance
  let isAuditMode = false;

  function getActiveLic() {
    return licenses.find(l => l.id === activeLicId);
  }

  function getFilteredApps(licType, isEdu, licId) {
    let apps = adobeApps.slice();
    if (licType === 'restricted') {
      apps = apps.filter(app =>
        app.category === 'desktop' ||
        app.category === 'eol' ||
        app.category === 'substance'
      );
      apps = apps.filter(app => !app.sdl_excluded);
    }
    if (!isEdu || licId === 'gov_frl') {
      apps = apps.filter(app => app.category !== 'substance');
    }
    if (licId === 'gov_frl') {
      apps = apps.filter(app => !app.frl_excluded);
    }
    return apps;
  }

  function getTenderText(lic, level) {
    const isRestrictedLocal = lic.type === 'restricted';
    const apps = getFilteredApps(lic.type, lic.isEdu, lic.id);
    let summary = level === 'flagship'
      ? lic.summaryFlagship
      : level === 'essential'
        ? lic.summaryEssential
        : lic.summarySubstance;

    const desktopApps = apps
      .filter(a => a.category === 'desktop')
      .map(a => `${a.name}${a.alert ? ` (${a.alert})` : ''}`)
      .join('\n   - ');

    const substanceApps = apps
      .filter(a => a.category === 'substance')
      .map(a => a.name)
      .join(', ');

    const mobileApps = apps
      .filter(a => a.category === 'cloud')
      .map(a => {
        const p = [];
        if (a.has_web) p.push('Web');
        if (a.has_ios) p.push('iOS');
        if (a.has_android) p.push('Android');
        return `${a.name} [${p.join('/')}]`;
      })
      .join('\n   - ');

    const eolApps = apps
      .filter(a => a.category === 'eol')
      .map(a => `${a.name}: ${a.alert || ''}`)
      .join('\n   - ');

    let text = `【Adobe CC 2026 (v26) 硬體採購規格書 - ${lic.name}】
採購等級：${level === 'flagship' ? '全套旗艦規格' : level === 'essential' ? '基礎平面規格' : 'Substance 3D 專用'}
資料來源：Adobe 官方網站 (HelpX) - 2025/2026 Release

【資安風險聲明 (Security Advisory)】
微軟將於 2025 年 10 月 14 日終止 Windows 10 支援。
為資安合規，強烈建議採購 Windows 11。
參考連結：https://support.microsoft.com/zh-tw/windows/windows-10-%E6%94%AF%E6%8F%B4%E5%B7%B2%E6%96%BC-2025-%E5%B9%B4-10-%E6%9C%88-14-%E6%97%A5%E7%B5%90%E6%9D%9F-2ca8b313-1946-43d3-b55c-2b95b107f281

【硬體規格總結】
● 作業系統：Windows 11 (建議) / Windows 10 22H2 (最低)
● 處理器 (CPU)：${summary && summary.cpu ? summary.cpu : '-'} ${level === 'essential' ? '' : '(需支援 AVX2 指令集)'}
● 記憶體 (RAM)：${summary && summary.ram ? summary.ram : '-'}
● 顯示卡 (GPU)：${summary && summary.gpu ? summary.gpu : '-'}

=== 軟體授權清單 (桌面端) ===
本案採購包含 Adobe Creative Cloud 全套授權，桌面軟體清單如下：
   - ${desktopApps}
`;

    if (substanceApps && substanceApps.length > 0) {
      text += `

=== 教育版專屬權益 (不包含Substance 3D Assets) ===
本授權方案包含以下 3D 創作軟體：
   - ${substanceApps}
`;
    }

    text += `

=== 特別註記軟體 (不列入規格計算) ===
以下軟體雖包含於授權中 (部分例外)，但因狀態特殊，不列入硬體效能評估：
   - ${eolApps}
`;

    if (!isRestrictedLocal) {
      text += `

=== 行動裝置應用程式 (Mobile Apps) 與 網頁服務 ===
包含以下項目 (需具備 Adobe ID 登入權限)：
   - ${mobileApps}
`;
    } else {
      text += `

★ 排除項目宣告 (SDL/FRL 限制):
- 本案採購之授權為【${lic.name}】，不包含行動裝置 App 與雲端服務。
`;
    }

    return text;
  }

  // ====== Rendering ======
  function iconSvg(id) {
    return `<svg><use href="#icon-${id}"></use></svg>`;
  }

  function renderSidebar() {
    const commWrap = document.getElementById('comm-gov-list');
    const eduWrap = document.getElementById('edu-list');
    commWrap.innerHTML = '';
    eduWrap.innerHTML = '';
    const activeId = activeLicId;

    licenses.filter(l => l.group === 'comm_gov').forEach(lic => {
      const btn = document.createElement('button');
      btn.className = 'lic-btn' + (lic.id === activeId ? ' active' : '');
      btn.dataset.licId = lic.id;
      btn.innerHTML = `
        <div class="lic-btn-icon">
          ${iconSvg(lic.icon)}
        </div>
        <span>${lic.short}</span>
      `;
      commWrap.appendChild(btn);
    });

    licenses.filter(l => l.group === 'edu').forEach(lic => {
      const btn = document.createElement('button');
      btn.className = 'lic-btn' + (lic.id === activeId ? ' active' : '');
      btn.dataset.licId = lic.id;
      btn.innerHTML = `
        <div class="lic-btn-icon">
          ${iconSvg(lic.icon)}
        </div>
        <span>${lic.short}</span>
      `;
      eduWrap.appendChild(btn);
    });
  }

  function renderMainHeader() {
    const lic = getActiveLic();
    const titleEl = document.getElementById('lic-title');
    const subEl = document.getElementById('lic-subtitle');
    titleEl.textContent = lic.name;
    subEl.textContent = lic.type === 'restricted'
      ? '⚠️ 限制型授權：僅包含桌面端軟體，已自動過濾不適用項目。'
      : '✅ 完整型授權：包含桌面、行動裝置與雲端服務。';

    // Tender buttons
    const tenderBtns = document.querySelectorAll('.tender-btn');
    tenderBtns.forEach(btn => {
      const level = btn.dataset.level;
      btn.classList.remove('active', 'flagship', 'essential', 'substance');
      if (level === tenderLevel) {
        btn.classList.add('active', level);
      }
      // Substance 按鈕在非 Edu 或 gov_frl 時禁用
      if (level === 'substance') {
        if (!lic.isEdu || lic.id === 'gov_frl') {
          btn.disabled = true;
          btn.style.opacity = 0.4;
        } else {
          btn.disabled = false;
          btn.style.opacity = 1;
        }
      }
    });

    // Audit button
    const auditBtn = document.getElementById('audit-toggle');
    const auditText = auditBtn.querySelector('.audit-text');
    if (isAuditMode) {
      auditBtn.classList.add('btn-audit-on');
      auditText.textContent = '關閉稽核';
      auditBtn.querySelector('svg use').setAttribute('href', '#icon-eye');
    } else {
      auditBtn.classList.remove('btn-audit-on');
      auditText.textContent = '資料稽核';
      auditBtn.querySelector('svg use').setAttribute('href', '#icon-clipboard-check');
    }
  }

  function renderSummaryBanner() {
    const lic = getActiveLic();
    const wrap = document.getElementById('summary-banner');
    let summary;
    if (tenderLevel === 'flagship') summary = lic.summaryFlagship;
    else if (tenderLevel === 'essential') summary = lic.summaryEssential;
    else summary = lic.summarySubstance;

    if (!summary) {
      wrap.innerHTML = '';
      return;
    }

    let title;
    if (tenderLevel === 'flagship') title = '全套旗艦安裝・高階影視門檻';
    else if (tenderLevel === 'essential') title = '基礎平面安裝・一般設計門檻';
    else title = 'Substance 3D 專用・高階 3D 門檻';

    const bannerClass = tenderLevel === 'flagship' ? 'flagship'
                      : tenderLevel === 'essential' ? 'essential'
                      : 'substance';

    wrap.innerHTML = `
      <div class="summary-banner ${bannerClass}">
        <div class="summary-banner-icon-bg">
          ${iconSvg('zap')}
        </div>
        <div class="summary-banner-title">
          <span>${iconSvg('check-circle')}</span>
          <span>${title}</span>
        </div>
        <div class="summary-banner-advisory">
          <div style="flex-shrink:0;">
            <div style="background:#f97373;color:#fff;width:34px;height:34px;border-radius:999px;display:flex;align-items:center;justify-content:center;">
              ${iconSvg('calendar-clock')}
            </div>
          </div>
          <div>
            <div style="font-size:0.8rem;font-weight:700;">資安風險聲明 (Security Advisory)</div>
            <p style="font-size:0.75rem;line-height:1.4;margin:0.2rem 0 0;">
              微軟將於 2025 年 10 月 14 日終止 Windows 10 支援。為資安合規，建議全面採購 Windows 11。
            </p>
          </div>
        </div>
        <div class="summary-banner-grid">
          <div class="summary-banner-card">
            <div class="summary-banner-card-label">
              ${iconSvg('hard-drive')}
              <span>OS 系統</span>
            </div>
            <div class="summary-banner-card-value">${summary.os}</div>
          </div>
          <div class="summary-banner-card">
            <div class="summary-banner-card-label">
              ${iconSvg('cpu')}
              <span>處理器 CPU</span>
            </div>
            <div class="summary-banner-card-value">${summary.cpu}</div>
            <div class="summary-banner-card-sub">${tenderLevel === 'flagship' ? '需支援 AVX2 指令集' : '一般設計使用足夠'}</div>
          </div>
          <div class="summary-banner-card">
            <div class="summary-banner-card-label">
              ${iconSvg('layers')}
              <span>記憶體 RAM</span>
            </div>
            <div class="summary-banner-card-value">${summary.ram}</div>
            <div class="summary-banner-card-sub">${tenderLevel === 'flagship' ? 'AE/PR 長時間剪輯建議' : 'PS/AI 使用足夠'}</div>
          </div>
          <div class="summary-banner-card">
            <div class="summary-banner-card-label">
              ${iconSvg('monitor')}
              <span>顯示卡 GPU</span>
            </div>
            <div class="summary-banner-card-value">${summary.gpu}</div>
            <div class="summary-banner-card-sub">${tenderLevel === 'flagship' ? '支援硬體加速與 4K 工作流' : '基本硬體加速即可'}</div>
          </div>
        </div>
      </div>
    `;
  }

  function platformBadges(app) {
    const badges = [];
    if (app.has_web) {
      badges.push('<span class="platform-badge web">Web</span>');
    }
    if (app.has_ios) {
      badges.push('<span class="platform-badge ios">iOS</span>');
    }
    if (app.has_android) {
      badges.push('<span class="platform-badge android">Android</span>');
    }
    return badges.join('');
  }

  function renderAppTable(title, iconId, apps, opts) {
    if (!apps.length) return '';
    const { showSystemCols, isAuditModeLocal, level } = opts;

    let theadCols = `
      <th>軟體名稱 / 版本 / 支援平台</th>
    `;
    if (showSystemCols) {
      theadCols += `
        <th>Windows 需求</th>
        <th>macOS 需求</th>
        <th>硬體建議 (RAM / GPU)</th>
      `;
    }
    if (isAuditModeLocal) {
      theadCols += `<th class="audit-col">官方溯源稽核</th>`;
    }

    const rows = apps.map(app => {
      const isDimmed = (level === 'essential' && app.is_heavy) || app.is_eol;
      const classesRow = isDimmed ? 'app-dimmed' : '';
      const showSystem = app.category === 'desktop' || app.category === 'substance' || app.category === 'eol';
      const versionOrPlatform = app.category === 'cloud'
        ? `<div class="app-platform-badges">${platformBadges(app)}</div>`
        : `<div class="app-version">${app.version}</div>`;

      let alertHtml = '';
      if (app.alert) {
        const alertClass = app.is_eol ? 'app-alert-eol' : 'app-alert-normal';
        const alertIcon = app.is_eol ? 'x-circle' : 'alert-triangle';
        alertHtml = `
          <div class="app-alert-pill ${alertClass}">
            ${iconSvg(alertIcon)}
            <span>${app.alert}</span>
          </div>
        `;
      }

      let systemCols = '';
      if (showSystemCols && showSystem) {
        systemCols = `
          <td>
            <div style="font-weight:500;">${app.min_os_win}</div>
            ${app.min_os_win !== '-' ? '<div style="font-size:0.7rem;color:#9ca3af;">最低支援版本</div>' : ''}
          </td>
          <td>
            <div style="font-weight:500;${app.min_os_mac.includes('不支援') ? 'color:#dc2626;' : ''}">${app.min_os_mac}</div>
            ${app.min_os_mac.includes('14') && !isDimmed ? '<div style="font-size:0.7rem;color:#b45309;">建議 Sonoma 最佳</div>' : ''}
          </td>
          <td>
            <div style="font-size:0.8rem;">
              <div style="display:flex;justify-content:space-between;gap:0.5rem;">
                <span style="font-size:0.7rem;color:#94a3b8;">RAM</span>
                <span style="font-weight:500;">'${app.rec_ram}'</span>
              </div>
              <div style="display:flex;justify-content:space-between;gap:0.5rem;">
                <span style="font-size:0.7rem;color:#94a3b8;">GPU</span>
                <span style="font-weight:500;">'${app.rec_gpu}'</span>
              </div>
            </div>
          </td>
        `;
      } else if (showSystemCols) {
        systemCols = `
          <td></td><td></td><td></td>
        `;
      }

      let auditCol = '';
      if (isAuditModeLocal) {
        auditCol = `
          <td class="audit-col">
            <a class="audit-link" href="${app.url}" target="_blank" rel="noopener">
              ${iconSvg('external-link')}
              <span>開啟官網查證</span>
            </a>
            <label class="audit-checkbox-label">
              <input type="checkbox" />
              <span>已確認</span>
            </label>
          </td>
        `;
      }

      return `
        <tr class="${classesRow}">
          <td>
            <button class="app-name-btn app-row-button" data-app-id="${app.id}">
              <div class="app-icon-badge">
                ${iconSvg(app.icon)}
              </div>
              <div>
                <div class="app-name-main">
                  <span>${app.name}</span>
                  ${app.is_eol ? '<span class="app-chip-eol">不列入規格</span>' : ''}
                </div>
                ${versionOrPlatform}
                ${isDimmed && !app.is_eol ? '<div style="font-size:0.65rem;font-weight:700;color:#6b7280;margin-top:0.15rem;">[非基礎安裝核心軟體]</div>' : ''}
                ${alertHtml}
              </div>
            </button>
          </td>
          ${systemCols}
          ${auditCol}
        </tr>
      `;
    }).join('');

    return `
      <div class="table-card">
        <div class="table-card-header">
          ${iconSvg(iconId)}
          <span>${title}</span>
        </div>
        <div style="overflow-x:auto;">
          <table>
            <thead>
              <tr>${theadCols}</tr>
            </thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      </div>
    `;
  }

  function renderTables() {
    const lic = getActiveLic();
    const apps = getFilteredApps(lic.type, lic.isEdu, lic.id);
    const desktopApps = apps.filter(a => a.category === 'desktop');
    const substanceApps = apps.filter(a => a.category === 'substance');
    const cloudApps = apps.filter(a => a.category === 'cloud');
    const eolApps = apps.filter(a => a.category === 'eol');
    const tablesWrap = document.getElementById('tables');

    const showSysColsDesktop = true;
    const showSysColsSubstance = true;
    const showSysColsEol = true;
    const tablesHtml = [];

    tablesHtml.push(
      renderAppTable(
        '桌面軟體 (Desktop Apps)',
        'monitor',
        desktopApps,
        { showSystemCols: showSysColsDesktop, isAuditModeLocal: isAuditMode, level: tenderLevel }
      )
    );

    if (substanceApps.length) {
      tablesHtml.push(
        renderAppTable(
          '教育版專屬權益 (不包含Substance 3D Assets)',
          'boxes',
          substanceApps,
          { showSystemCols: showSysColsSubstance, isAuditModeLocal: isAuditMode, level: tenderLevel }
        )
      );
    }

    if (eolApps.length) {
      tablesHtml.push(
        renderAppTable(
          '特殊狀態軟體 (EOL / Free)',
          'alert-octagon',
          eolApps,
          { showSystemCols: showSysColsEol, isAuditModeLocal: isAuditMode, level: tenderLevel }
        )
      );
    }

    if (cloudApps.length) {
      tablesHtml.push(
        renderAppTable(
          '行動裝置應用程式 (Mobile Apps) 與 網頁服務',
          'smartphone',
          cloudApps,
          { showSystemCols: false, isAuditModeLocal: isAuditMode, level: tenderLevel }
        )
      );
    }

    tablesWrap.innerHTML = tablesHtml.join('');

    const restrictedWrap = document.getElementById('restricted-note-wrap');
    if (lic.type === 'restricted') {
      restrictedWrap.innerHTML = `
        <div class="restricted-note">
          ${iconSvg('cloud-off')}
          <div style="font-weight:700;color:#4b5563;">行動裝置與雲端服務區塊已隱藏</div>
          <p style="margin:0.25rem 0 0;font-size:0.8rem;">
            依據您選擇的 <strong>${lic.short}</strong> 規範，不包含 Photoshop for iPad、Firefly Web 等服務。<br/>
            此區塊已自動從投標規格書中移除。
          </p>
        </div>
      `;
    } else {
      restrictedWrap.innerHTML = '';
    }
  }

  function openModal(appId) {
    const app = adobeApps.find(a => a.id === appId);
    if (!app) return;
    const backdrop = document.getElementById('modal-backdrop');
    const iconDiv = document.getElementById('modal-icon');
    const title = document.getElementById('modal-title');
    const subtitle = document.getElementById('modal-subtitle');
    const body = document.getElementById('modal-body');
    const linkBtn = document.getElementById('modal-link');

    iconDiv.className = 'modal-icon desktop';
    if (app.category === 'substance') iconDiv.className = 'modal-icon substance';
    else if (app.category === 'cloud') iconDiv.className = 'modal-icon cloud';
    else if (app.category === 'eol') iconDiv.className = 'modal-icon eol';

    iconDiv.innerHTML = iconSvg(app.icon);
    title.textContent = app.name;
    subtitle.textContent = `${app.category.toUpperCase()} • ${app.version}`;
    body.textContent = app.intro || app.desc;
    linkBtn.onclick = () => {
      window.open(app.url, '_blank');
    };

    backdrop.classList.add('show');
  }

  function closeModal() {
    document.getElementById('modal-backdrop').classList.remove('show');
  }

  function updateAll() {
    const lic = getActiveLic();
    // If non-edu or gov_frl, force non-substance level
    if ((!lic.isEdu || lic.id === 'gov_frl') && tenderLevel === 'substance') {
      tenderLevel = 'flagship';
    }
    renderSidebar();
    renderMainHeader();
    renderSummaryBanner();
    renderTables();
  }

  // ====== Events ======
  document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    const mobileToggle = document.getElementById('mobile-menu-toggle');
    const sidebarClose = document.getElementById('sidebar-close');

    function openSidebar() {
      sidebar.classList.add('open');
      overlay.classList.add('show');
    }
    function closeSidebar() {
      sidebar.classList.remove('open');
      overlay.classList.remove('show');
    }

    mobileToggle.addEventListener('click', openSidebar);
    sidebarClose.addEventListener('click', closeSidebar);
    overlay.addEventListener('click', closeSidebar);

    document.getElementById('comm-gov-list').addEventListener('click', (e) => {
      const btn = e.target.closest('.lic-btn');
      if (!btn) return;
      activeLicId = btn.dataset.licId;
      tenderLevel = 'flagship';
      closeSidebar();
      updateAll();
    });

    document.getElementById('edu-list').addEventListener('click', (e) => {
      const btn = e.target.closest('.lic-btn');
      if (!btn) return;
      activeLicId = btn.dataset.licId;
      tenderLevel = 'flagship';
      closeSidebar();
      updateAll();
    });

    document.getElementById('tender-toggle').addEventListener('click', (e) => {
      const btn = e.target.closest('.tender-btn');
      if (!btn || btn.disabled) return;
      const lvl = btn.dataset.level;
      const lic = getActiveLic();
      if (lvl === 'substance' && (!lic.isEdu || lic.id === 'gov_frl')) return;
      tenderLevel = lvl;
      updateAll();
    });

    document.getElementById('audit-toggle').addEventListener('click', () => {
      isAuditMode = !isAuditMode;
      updateAll();
    });

    document.getElementById('tables').addEventListener('click', (e) => {
      const btn = e.target.closest('.app-row-button');
      if (!btn) return;
      const appId = btn.dataset.appId;
      openModal(appId);
    });

    document.getElementById('modal-close').addEventListener('click', closeModal);
    document.getElementById('modal-backdrop').addEventListener('click', (e) => {
      if (e.target.id === 'modal-backdrop') closeModal();
    });

    document.getElementById('copy-btn').addEventListener('click', () => {
      const lic = getActiveLic();
      const text = getTenderText(lic, tenderLevel);
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position = 'fixed';
      ta.style.top = '-1000px';
      document.body.appendChild(ta);
      ta.focus();
      ta.select();
      try {
        document.execCommand('copy');
        const btn = document.getElementById('copy-btn');
        btn.classList.add('copied');
        btn.querySelector('span').textContent = '已複製';
        btn.querySelector('svg use').setAttribute('href', '#icon-check-circle');
        setTimeout(() => {
          btn.classList.remove('copied');
          btn.querySelector('span').textContent = '複製當下規格';
          btn.querySelector('svg use').setAttribute('href', '#icon-copy');
        }, 2000);
      } catch (e) {}
      document.body.removeChild(ta);
    });

    document.getElementById('download-btn').addEventListener('click', () => {
      const lic = getActiveLic();
      const text = getTenderText(lic, tenderLevel);
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `Adobe_Spec_${lic.short}_${tenderLevel}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    updateAll();
  });
</script>
</body>
</html> 
