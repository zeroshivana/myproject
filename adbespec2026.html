<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adobe CC 2026 ç¡¬é«”æ¡è³¼è¦æ ¼è¼”åŠ©ç³»çµ±</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Scrollbar styling for sidebar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen">

    <div class="lg:hidden bg-white border-b border-slate-200 p-4 flex justify-between items-center sticky top-0 z-40">
        <div class="flex items-center gap-2 text-red-600 font-black text-lg">
            <i data-lucide="globe" class="w-5 h-5"></i>
            <span>ADOBE SPEC</span>
        </div>
        <button onclick="toggleSidebar()" class="p-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors">
            <i data-lucide="menu" class="w-5 h-5"></i>
        </button>
    </div>

    <div class="lg:flex relative">
        
        <div id="sidebar-container" class="fixed inset-y-0 left-0 z-50 w-72 bg-white border-r border-slate-200 transform transition-transform -translate-x-full lg:translate-x-0 lg:static lg:h-screen lg:sticky lg:top-0 flex flex-col shadow-2xl lg:shadow-none">
            <div class="p-4 border-b border-slate-100 hidden lg:block">
                <div class="flex items-center gap-2 text-red-600 font-black text-lg">
                    <i data-lucide="globe" class="w-5 h-5"></i>
                    <span>ADOBE SPEC <span class="text-slate-400 font-normal">2026</span></span>
                </div>
                <div class="text-[10px] text-slate-400 font-medium mt-1">æ”¿åºœ/æ•™è‚² æ¡è³¼è¦æ ¼è¼”åŠ©ç³»çµ±</div>
            </div>

            <div class="p-4 lg:hidden flex justify-end">
                <button onclick="toggleSidebar()"><i data-lucide="x" class="w-6 h-6 text-slate-400"></i></button>
            </div>

            <div id="sidebar-menu" class="flex flex-col gap-6 p-4 overflow-y-auto flex-1"></div>
        </div>

        <div id="mobile-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>

        <div class="flex-1 p-4 lg:p-8 w-full min-h-screen">
            <div class="max-w-7xl mx-auto space-y-8" id="main-content">
                </div>
            
            <div class="h-20 lg:h-0"></div>
        </div>

    </div>

    <div id="modal-container"></div>

    <script>
        // --- DATA ---
        const adobeApps = [
            // Desktop
            { id: 'ps', name: 'Photoshop', category: 'desktop', icon: 'image', version: '2026 (v27)', desc: 'å½±åƒç·¨è¼¯', intro: 'å…¨çƒæ¨™æº–çš„å½±åƒåˆæˆèˆ‡ç·¨è¼¯è»Ÿé«”ï¼Œæ”¯æ´ AI ç”Ÿæˆå¡«è‰²èˆ‡é€²éšä¿®åœ–åŠŸèƒ½ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB+', rec_gpu: '4GB VRAM', level: 60, is_heavy: false, alert: 'å»ºè­° macOS 14 æœ€ä½³', url: 'https://helpx.adobe.com/tw/photoshop/system-requirements.html' },
            { id: 'ai', name: 'Illustrator', category: 'desktop', icon: 'pen-tool', version: '2026 (v30)', desc: 'å‘é‡ç¹ªåœ–', intro: 'å‘é‡åœ–å½¢è¨­è¨ˆæ¨™æº–å·¥å…·ï¼Œé©ç”¨æ–¼æ¨™èªŒã€åœ–ç¤ºã€æ’ç•«èˆ‡åŒ…è£è¨­è¨ˆã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB+', rec_gpu: '4GB VRAM', level: 50, is_heavy: false, url: 'https://helpx.adobe.com/tw/illustrator/system-requirements.html' },
            { id: 'id', name: 'InDesign', category: 'desktop', icon: 'file-text', version: '2026 (v21)', desc: 'æ’ç‰ˆè¨­è¨ˆ', intro: 'å°ˆæ¥­ç‰ˆé¢è¨­è¨ˆèˆ‡æ’ç‰ˆè»Ÿé«”ï¼Œé©ç”¨æ–¼é›œèªŒã€æ›¸ç±ã€æ•¸ä½å‡ºç‰ˆèˆ‡äº’å‹•æ–‡ä»¶ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: false, url: 'https://helpx.adobe.com/tw/indesign/system-requirements.html' },
            { id: 'ic', name: 'InCopy', category: 'desktop', icon: 'type', version: '2026 (v21)', desc: 'æ–‡ç¨¿ç·¨è¼¯', intro: 'èˆ‡ InDesign å”ä½œçš„æ–‡ç¨¿æ’°å¯«å·¥å…·ï¼Œè®“ç·¨è¼¯èˆ‡è¨­è¨ˆå¸«èƒ½åŒæ™‚è™•ç†åŒä¸€ä»½æ–‡ä»¶ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 30, is_heavy: false, url: 'https://helpx.adobe.com/tw/incopy/system-requirements.html' },
            { id: 'ac', name: 'Acrobat Pro', category: 'desktop', icon: 'file-text', version: 'DC (Continuous)', desc: 'PDFæ–‡ä»¶', intro: 'æœ€å®Œæ•´çš„ PDF è§£æ±ºæ–¹æ¡ˆï¼Œæ”¯æ´å»ºç«‹ã€ç·¨è¼¯ã€ç°½ç½²èˆ‡ä¿è­· PDF æ–‡ä»¶ã€‚', min_os_win: 'Win 10 (1809)', min_os_mac: 'macOS 12', rec_ram: '8GB', rec_gpu: 'é¸ç”¨', level: 10, is_heavy: false, url: 'https://helpx.adobe.com/tw/acrobat/system-requirements.html' },
            { id: 'lrc', name: 'Lightroom Classic', category: 'desktop', icon: 'image', version: '2026 (v15)', desc: 'ç›¸ç‰‡ç®¡ç†', intro: 'å°ˆç‚ºæ”å½±å¸«è¨­è¨ˆçš„æ¡Œé¢ç«¯ç›¸ç‰‡ç®¡ç†èˆ‡ä¿®åœ–è»Ÿé«”ï¼Œæä¾›å¼·å¤§çš„æ‰¹æ¬¡è™•ç†åŠŸèƒ½ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB+', rec_gpu: '8GB VRAM', level: 60, is_heavy: false, url: 'https://helpx.adobe.com/tw/lightroom-classic/system-requirements.html' },
            { id: 'pr', name: 'Premiere Pro', category: 'desktop', icon: 'video', version: '2026 (v26)', desc: 'å½±ç‰‡å‰ªè¼¯', intro: 'æ¥­ç•Œæ¨™æº–çš„å°ˆæ¥­å½±ç‰‡å‰ªè¼¯è»Ÿé«”ï¼Œæ”¯æ´å¾ 8K åˆ°è™›æ“¬å¯¦å¢ƒçš„å„ç¨®æ ¼å¼ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '32GB (4K)', rec_gpu: '6GB+ VRAM', level: 85, is_heavy: true, alert: 'ä»‹é¢åƒ…æ”¯æ´ç°¡é«”ä¸­æ–‡ / CPUéœ€æ”¯æ´ AVX2', url: 'https://helpx.adobe.com/cn/premiere-pro/system-requirements.html' },
            { id: 'ae', name: 'After Effects', category: 'desktop', icon: 'layers', version: '2026 (v26)', desc: 'ç‰¹æ•ˆåˆæˆ', intro: 'é›»å½±ç´šè¦–è¦ºç‰¹æ•ˆèˆ‡å‹•æ…‹åœ–å½¢åˆæˆè»Ÿé«”ï¼Œå»£æ³›ç”¨æ–¼é›»å½±ã€é›»è¦–èˆ‡ç¶²é å½±ç‰‡ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '32GB / 64GB', rec_gpu: '8GB+ VRAM', level: 100, is_heavy: true, alert: 'ä»‹é¢åƒ…æ”¯æ´ç°¡é«”ä¸­æ–‡ / 4Kå»ºè­° 64GB RAM', url: 'https://helpx.adobe.com/cn/after-effects/system-requirements.html' },
            { id: 'au', name: 'Audition', category: 'desktop', icon: 'mic', version: '2026 (v26)', desc: 'éŸ³è¨Šç·¨è¼¯', intro: 'å°ˆæ¥­éŸ³è¨Šå·¥ä½œç«™ï¼Œæä¾›æ··éŸ³ã€ä¿®å¾©èˆ‡ç²¾æº–ç·¨è¼¯åŠŸèƒ½ï¼Œé‚„åŸç´”æ·¨éŸ³è³ªã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB', rec_gpu: '2GB VRAM', level: 40, is_heavy: true, alert: 'ä»‹é¢åƒ…æ”¯æ´ç°¡é«”ä¸­æ–‡', url: 'https://helpx.adobe.com/cn/audition/system-requirements.html' },
            { id: 'me', name: 'Media Encoder', category: 'desktop', icon: 'settings', version: '2026 (v26)', desc: 'å½±éŸ³è½‰æª”', intro: 'å…¨èƒ½å½±éŸ³è½‰æª”å·¥å…·ï¼Œæ”¯æ´å¹¾ä¹æ‰€æœ‰æ ¼å¼ï¼Œå¯èƒŒæ™¯åŸ·è¡Œç®—åœ–ä»»å‹™ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: true, url: 'https://helpx.adobe.com/tw/media-encoder/system-requirements.html' },
            { id: 'ch', name: 'Character Animator', category: 'desktop', icon: 'users', version: '2026 (v26)', desc: 'å‹•ç•«æ•æ‰', intro: 'åˆ©ç”¨ç¶²è·¯æ”å½±æ©Ÿå³æ™‚æ•æ‰è¡¨æƒ…å‹•ä½œï¼Œè®“ 2D è§’è‰²ç¬é–“æ´»èµ·ä¾†çš„å‹•ç•«å·¥å…·ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 12', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 50, is_heavy: true, url: 'https://helpx.adobe.com/tw/character-animator/system-requirements.html' },
            { id: 'an', name: 'Animate', category: 'desktop', icon: 'clapperboard', version: '2026 (v26)', desc: '2Då‹•ç•«', intro: 'äº’å‹•å¼å‘é‡å‹•ç•«è¨­è¨ˆå·¥å…·ï¼ˆå‰èº«ç‚º Flashï¼‰ï¼Œé©ç”¨æ–¼éŠæˆ²ã€æ‡‰ç”¨ç¨‹å¼èˆ‡ç¶²é ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 12', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 40, is_heavy: true, alert: 'Mac ç‰ˆä¸æ”¯æ´ä¸­æ–‡ä»‹é¢', url: 'https://helpx.adobe.com/tw/animate/system-requirements.html' },
            { id: 'dw', name: 'Dreamweaver', category: 'desktop', icon: 'code', version: '2021 (v21)', desc: 'ç¶²é è¨­è¨ˆ', intro: 'æ”¯æ´ HTML/CSS/JS çš„è¦–è¦ºåŒ–ç¶²é è¨­è¨ˆèˆ‡ç¨‹å¼ç¢¼ç·¨è¼¯å·¥å…·ã€‚', min_os_win: 'Win 10 (1903)', min_os_mac: 'macOS 11', rec_ram: '4GB', rec_gpu: '1GB VRAM', level: 20, is_heavy: false, alert: 'Mac ç‰ˆä¸æ”¯æ´ä¸­æ–‡ä»‹é¢', url: 'https://helpx.adobe.com/tw/dreamweaver/system-requirements.html' },
            { id: 'br', name: 'Bridge', category: 'desktop', icon: 'boxes', version: '2026 (v16)', desc: 'è³‡ç”¢ç®¡ç†', intro: 'å¼·å¤§çš„å‰µæ„è³‡ç”¢ç®¡ç†å“¡ï¼Œå¯é è¦½ã€æ•´ç†ã€ç·¨è¼¯èˆ‡ç™¼ä½ˆå¤šç¨®å‰µæ„æª”æ¡ˆã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 20, is_heavy: false, url: 'https://helpx.adobe.com/tw/bridge/system-requirements.html' },
            { id: 'lr', name: 'Adobe Lightroom', category: 'desktop', icon: 'cloud', version: '2026', desc: 'é›²ç«¯ç›¸ç‰‡æœå‹™', intro: 'åŸºæ–¼é›²ç«¯çš„ç›¸ç‰‡æœå‹™ï¼Œéš¨æ™‚éš¨åœ°ç·¨è¼¯ã€æ•´ç†ã€å„²å­˜èˆ‡åˆ†äº«ç›¸ç‰‡ã€‚', min_os_win: 'Win 10 (22H2)', min_os_mac: 'macOS 13', rec_ram: '8GB', rec_gpu: '2GB VRAM', level: 40, is_heavy: false, sdl_excluded: true, url: 'https://helpx.adobe.com/tw/lightroom-cc/system-requirements.html' },
            
            // Substance
            { id: 'sub_pt', name: 'Substance 3D Painter', category: 'substance', icon: 'box', version: '2026', desc: '3D æè³ªç¹ªè£½', intro: '3D ç•Œçš„ Photoshopï¼Œå¯ç›´æ¥åœ¨ 3D æ¨¡å‹ä¸Šç¹ªè£½æè³ªèˆ‡ç´‹ç†ã€‚', min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12', rec_ram: '32GB', rec_gpu: '8GB+ VRAM', level: 90, is_heavy: true, frl_excluded: true, url: 'https://helpx.adobe.com/substance-3d-painter/getting-started/system-requirements.html' },
            { id: 'sub_ds', name: 'Substance 3D Designer', category: 'substance', icon: 'grid', version: '2026', desc: '3D æè³ªè¨­è¨ˆ', intro: 'åŸºæ–¼ç¯€é»çš„æè³ªå‰µä½œå·¥å…·ï¼Œå¯å¾ç„¡åˆ°æœ‰è¨­è¨ˆå‡ºç„¡é™è®ŠåŒ–çš„ 3D æè³ªã€‚', min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12', rec_ram: '32GB', rec_gpu: '8GB+ VRAM', level: 85, is_heavy: true, frl_excluded: true, url: 'https://helpx.adobe.com/substance-3d-designer/home.html' },
            { id: 'sub_sg', name: 'Substance 3D Stager', category: 'substance', icon: 'image', version: '2026', desc: '3D å ´æ™¯ä½ˆç½®', intro: 'ç›´è¦ºçš„ 3D å ´æ™¯ä½ˆç½®èˆ‡ç®—åœ–å·¥å…·ï¼Œç”¨æ–¼å»ºç«‹é«˜å“è³ªçš„è™›æ“¬æ”å½±æ£šç…§ã€‚', min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12', rec_ram: '32GB', rec_gpu: '8GB+ VRAM (RTX)', level: 95, is_heavy: true, frl_excluded: true, url: 'https://helpx.adobe.com/substance-3d-stager/getting-started/system-requirements.html' },
            { id: 'sub_sp', name: 'Substance 3D Sampler', category: 'substance', icon: 'camera', version: '2026', desc: 'æè³ªå–æ¨£', intro: 'åˆ©ç”¨ AI æŠ€è¡“å°‡å¯¦ç‰©ç…§ç‰‡å¿«é€Ÿè½‰æ›ç‚ºé«˜å“è³ª 3D æè³ªèˆ‡ç’°å¢ƒå…‰ã€‚', min_os_win: 'Win 10 22H2', min_os_mac: 'macOS 12', rec_ram: '16GB', rec_gpu: '4GB VRAM', level: 70, is_heavy: true, frl_excluded: true, url: 'https://helpx.adobe.com/substance-3d-sampler/getting-started/system-requirements.html' },
            { id: 'sub_md', name: 'Substance 3D Modeler', category: 'substance', icon: 'box', version: '2026', desc: 'VR/æ¡Œé¢å»ºæ¨¡', intro: 'çµåˆ VR èˆ‡æ¡Œé¢çš„ç›´è¦ºå¼ 3D å»ºæ¨¡å·¥å…·ï¼Œå¦‚åŒæé»åœŸèˆ¬è‡ªç”±å‰µä½œã€‚', min_os_win: 'Win 10 22H2', min_os_mac: 'ä¸æ”¯æ´ (åƒ…Win)', rec_ram: '32GB', rec_gpu: '8GB VRAM', level: 90, is_heavy: true, frl_excluded: true, alert: 'åƒ…æ”¯æ´ Windows (Desktop/VR)', url: 'https://helpx.adobe.com/substance-3d-modeler/getting-started/system-requirements.html' },

            // EOL
            { id: 'ru', name: 'Premiere Rush', category: 'eol', icon: 'video', version: '2026/9 çµ‚æ­¢æœå‹™', desc: 'è·¨è£ç½®å‰ªè¼¯', intro: 'è·¨è£ç½®è¼•é‡å‰ªè¼¯è»Ÿé«” (å°‡æ–¼ 2026 å¹´ 9 æœˆçµ‚æ­¢æœå‹™)ã€‚', min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, alert: '2026å¹´9æœˆåœæ­¢æœå‹™', sdl_excluded: true, url: 'https://helpx.adobe.com/tw/premiere-rush/system-requirements.html', is_eol: true },
            { id: 'xd', name: 'Adobe XD', category: 'eol', icon: 'layout', version: 'ç¶­è­·æ¨¡å¼', desc: 'UI/UX è¨­è¨ˆ', intro: 'UI/UX è¨­è¨ˆèˆ‡åŸå‹è£½ä½œå·¥å…· (ç›®å‰è™•æ–¼ç¶­è­·æ¨¡å¼ï¼Œä¸å†æ–°å¢åŠŸèƒ½)ã€‚', min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, alert: 'ç¶­è­·æ¨¡å¼ (ä¸å†æ›´æ–°)', sdl_excluded: true, url: 'https://helpx.adobe.com/tw/xd/system-requirements.html', is_eol: true },
            { id: 'fresco', name: 'Adobe Fresco', category: 'eol', icon: 'brush', version: 'å…è²»è»Ÿé«”', desc: 'æ•¸ä½ç¹ªåœ–', intro: 'å°ˆç‚ºè§¸æ§èˆ‡æ‰‹å¯«ç­†è¨­è¨ˆçš„æ•¸ä½ç¹ªåœ–è»Ÿé«” (ç¾å·²å…¨é¢å…è²»)ã€‚', min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, alert: 'å…è²»è»Ÿé«” (ä¸åˆ—å…¥è¦æ ¼)', url: 'https://helpx.adobe.com/tw/fresco/system-requirements.html', is_eol: true },
            { id: 'dn', name: 'Adobe Dimension', category: 'eol', icon: 'box', version: 'ç¶­è­·æ¨¡å¼', desc: '3D ç”¢å“åˆæˆ', intro: 'ç°¡æ˜“ 3D åˆæˆå·¥å…· (å› æ‡‰ Substance æ¨å‡ºï¼Œå¾ŒçºŒä¸æœƒå†æ›´æ–°)ã€‚', min_os_win: '-', min_os_mac: '-', rec_ram: '-', rec_gpu: '-', level: 0, is_heavy: false, alert: 'ç¶­è­·æ¨¡å¼ (ä¸å†æ›´æ–°)', is_eol: true, url: 'https://helpx.adobe.com/tw/dimension/system-requirements.html' },

            // Cloud/Mobile
            { id: 'firefly_mob', name: 'Adobe Firefly', category: 'cloud', icon: 'sparkles', version: 'AI å¼•æ“', desc: 'ç”Ÿæˆå¼ AI', intro: 'Adobe çš„ç”Ÿæˆå¼ AI å¼•æ“ï¼Œå¯é€éæ–‡å­—æŒ‡ä»¤ç”Ÿæˆé«˜å“è³ªå½±åƒèˆ‡æ–‡å­—ç‰¹æ•ˆã€‚', has_web: true, has_ios: true, has_android: true, url: 'https://firefly.adobe.com/' },
            { id: 'pr_mob', name: 'Adobe Premiere App', category: 'cloud', icon: 'video', version: 'Mobile', desc: 'è¡Œå‹•å‰ªè¼¯', intro: 'Premiere Pro çš„è¡Œå‹•ç‰ˆå»¶ä¼¸ï¼Œæä¾›æ‰‹æ©Ÿä¸Šçš„å°ˆæ¥­å‰ªè¼¯åŠŸèƒ½ã€‚', has_ios: true, has_android: true, url: 'https://www.adobe.com/tw/products/premiere-rush.html' },
            { id: 'express_mob', name: 'Adobe Express', category: 'cloud', icon: 'layout', version: 'All-in-One', desc: 'å¿«é€Ÿè¨­è¨ˆ', intro: 'å…¨èƒ½ç·šä¸Šè¨­è¨ˆå·¥å…·ï¼Œæ•´åˆæµ·å ±è£½ä½œã€å½±ç‰‡å‰ªè¼¯èˆ‡ PDF ç·¨è¼¯åŠŸèƒ½ã€‚', has_web: true, has_ios: true, has_android: true, url: 'https://www.adobe.com/tw/express/' },
            { id: 'capture', name: 'Adobe Capture', category: 'cloud', icon: 'camera', version: 'Mobile', desc: 'ç´ ææ“·å–', intro: 'å°‡æ‰‹æ©Ÿç›¸æ©Ÿè®Šæˆå‘é‡è½‰æ›å™¨ï¼Œéš¨æ™‚æ“·å–è‰²å½©ã€åœ–æ¡ˆèˆ‡å­—å‹ç´ æã€‚', has_ios: true, has_android: true, url: 'https://www.adobe.com/tw/products/capture.html' },
            { id: 'lr_mob', name: 'Adobe Lightroom (Mobile)', category: 'cloud', icon: 'image', version: 'Multi-Platform', desc: 'è¡Œå‹•ä¿®åœ–', intro: 'å¼·å¤§çš„é›²ç«¯ç›¸ç‰‡æœå‹™ï¼Œæ”¯æ´è·¨è£ç½®ç·¨è¼¯ã€æ•´ç†èˆ‡åˆ†äº«é«˜è§£æåº¦ç…§ç‰‡ã€‚', has_web: true, has_ios: true, has_android: true, url: 'https://www.adobe.com/tw/products/photoshop-lightroom.html' },
            { id: 'ac_mob', name: 'Adobe Acrobat Reader (Mobile)', category: 'cloud', icon: 'file-text', version: 'Multi-Platform', desc: 'PDF é–±è®€', intro: 'å…¨çƒæ¨™æº–çš„ PDF æª¢è¦–å™¨ï¼Œæ”¯æ´åœ¨è¡Œå‹•è£ç½®ä¸Šæª¢è¦–ã€ç°½ç½²èˆ‡è¨»è§£ PDFã€‚', has_web: true, has_ios: true, has_android: true, url: 'https://acrobat.adobe.com/tw/zh-Hant/mobile/acrobat-reader.html' },
            { id: 'behance', name: 'Behance', category: 'cloud', icon: 'globe', version: 'Service', desc: 'å‰µæ„ç¤¾ç¾¤', intro: 'å…¨çƒæœ€å¤§çš„å‰µæ„ä½œå“å±•ç¤ºå¹³å°ï¼Œå¯å»ºç«‹å€‹äººä½œå“é›†ä¸¦ç™¼æ˜éˆæ„Ÿã€‚', has_web: true, has_ios: true, has_android: true, url: 'https://www.behance.net/' },
            { id: 'font', name: 'Adobe Fonts', category: 'cloud', icon: 'type', version: 'Service', desc: 'é›²ç«¯å­—å‹', intro: 'æä¾›æ•¸åƒç¨®é«˜å“è³ªå­—å‹ï¼Œå¯ä¸€éµåŒæ­¥è‡³æ‰€æœ‰ Creative Cloud æ‡‰ç”¨ç¨‹å¼ã€‚', has_web: true, url: 'https://fonts.adobe.com/' },
            { id: 'color', name: 'Adobe Color', category: 'cloud', icon: 'palette', version: 'Service', desc: 'é…è‰²å·¥å…·', intro: 'å°ˆæ¥­é…è‰²æ–¹æ¡ˆç”¢ç”Ÿå™¨ï¼Œå¯å¾åœ–ç‰‡æ“·å–è‰²å½©æˆ–æ¢ç´¢ç¤¾ç¾¤å‰µä½œçš„è‰²ç¥¨ã€‚', has_web: true, url: 'https://color.adobe.com/' },
            { id: 'port', name: 'Adobe Portfolio', category: 'cloud', icon: 'globe', version: 'Service', desc: 'ä½œå“é›†ç¶²ç«™', intro: 'å¿«é€Ÿå»ºç«‹å€‹äººä½œå“é›†ç¶²ç«™çš„å·¥å…·ï¼Œç›´æ¥é€£å‹• Behance èˆ‡ Lightroomã€‚', has_web: true, url: 'https://portfolio.adobe.com/' }
        ];

        const licenses = [
            { id: 'commercial', name: 'æŒ‡åæˆæ¬Š-å•†æ¥­', short: 'å•†æ¥­æŒ‡å', color: 'blue', icon: 'building-2', summaryFlagship: { cpu: 'i7/i9 (14th)', ram: '64 GB', gpu: 'RTX 4070', os: 'Win 11 / Mac 14' }, summaryEssential: { cpu: 'i5 (13th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 11 / Mac 13' }, type: 'full', isEdu: false, group: 'comm_gov' },
            { id: 'gov_frl', name: 'é›¢ç·šæˆæ¬Š-æ”¿åºœFRL', short: 'æ”¿åºœ FRL', color: 'rose', icon: 'shield-alert', summaryFlagship: { cpu: 'Xeon W', ram: '64 GB+', gpu: 'RTX 4080', os: 'Win 11 (é›¢ç·š)' }, summaryEssential: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 11 (é›¢ç·š)' }, type: 'restricted', isEdu: false, group: 'comm_gov' },
            { id: 'edu_named', name: 'æŒ‡åæˆæ¬Š-æ•™è‚²å¤§å°ˆé™¢æ ¡', short: 'å¤§å°ˆæŒ‡å', color: 'indigo', icon: 'user', summaryFlagship: { cpu: 'i7 (13th)', ram: '32 GB', gpu: 'RTX 4060', os: 'Win 11 / Mac 14' }, summaryEssential: { cpu: 'i5 (13th)', ram: '16 GB', gpu: 'å…§é¡¯/å…¥é–€ç¨é¡¯', os: 'Win 11 / Mac 13' }, summarySubstance: { cpu: 'i7/i9', ram: '32 GB', gpu: 'RTX 3060+', os: 'Win 11 / Mac 14' }, type: 'full', isEdu: true, group: 'edu' },
            { id: 'k12_named', name: 'æŒ‡åæˆæ¬Š-æ•™è‚²K12', short: 'K12 æŒ‡å', color: 'emerald', icon: 'user', summaryFlagship: { cpu: 'i5 (13th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 13' }, summaryEssential: { cpu: 'i5 (12th)', ram: '8 GB', gpu: 'å…§é¡¯', os: 'Win 10 / Mac 13' }, summarySubstance: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 10 / Mac 14' }, type: 'full', isEdu: true, group: 'edu' },
            { id: 'edu_device', name: 'è£ç½®æˆæ¬Š-æ•™è‚²å¤§å°ˆé™¢æ ¡ SDL', short: 'å¤§å°ˆ SDL', color: 'purple', icon: 'school', summaryFlagship: { cpu: 'i7 (12th)', ram: '32 GB', gpu: 'RTX 3060', os: 'Win 10 / Mac 13' }, summaryEssential: { cpu: 'i5 (12th)', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 13' }, summarySubstance: { cpu: 'i7', ram: '32 GB', gpu: 'RTX 3060+', os: 'Win 10 / Mac 14' }, type: 'restricted', isEdu: true, group: 'edu' },
            { id: 'k12_device', name: 'è£ç½®æˆæ¬Š-æ•™è‚²K12 SDL', short: 'K12 SDL', color: 'teal', icon: 'users', summaryFlagship: { cpu: 'i5 (12th)', ram: '16 GB', gpu: 'GTX 1650', os: 'Win 10 / Mac 13' }, summaryEssential: { cpu: 'i5 (11th)', ram: '8 GB', gpu: 'å…§é¡¯', os: 'Win 10 / Mac 13' }, summarySubstance: { cpu: 'i5/i7', ram: '16 GB', gpu: 'RTX 3050', os: 'Win 10 / Mac 14' }, type: 'restricted', isEdu: true, group: 'edu' },
        ];

        // --- STATE & UTILS ---
        let state = {
            activeLicId: 'commercial',
            tenderLevel: 'flagship',
            isAuditMode: false,
            sidebarOpen: false,
            copyFeedback: false
        };

        const getActiveLic = () => licenses.find(l => l.id === state.activeLicId);

        const getFilteredApps = () => {
            const lic = getActiveLic();
            let apps = adobeApps;
            if (lic.type === 'restricted') {
                apps = apps.filter(app => app.category === 'desktop' || app.category === 'eol' || app.category === 'substance');
                apps = apps.filter(app => !app.sdl_excluded);
            }
            if (!lic.isEdu || lic.id === 'gov_frl') {
                apps = apps.filter(app => app.category !== 'substance');
            }
            if (lic.id === 'gov_frl') {
                apps = apps.filter(app => !app.frl_excluded);
            }
            return apps;
        };

        // --- RENDER FUNCTIONS ---

        function renderSidebar() {
            const commGovLics = licenses.filter(l => l.group === 'comm_gov');
            const eduLics = licenses.filter(l => l.group === 'edu');
            
            const renderBtn = (lic) => {
                const isActive = state.activeLicId === lic.id;
                const activeClass = `bg-${lic.color}-50 border border-${lic.color}-200 text-${lic.color}-800 shadow-sm`;
                const inactiveClass = `hover:bg-slate-50 text-slate-600`;
                const iconBg = isActive ? 'bg-white' : 'bg-slate-100';
                
                return `
                <button onclick="changeLicense('${lic.id}')" class="w-full flex items-center gap-3 p-2.5 rounded-lg transition-all text-left group ${isActive ? activeClass : inactiveClass}">
                    <div class="p-1.5 rounded-md ${iconBg}"><i data-lucide="${lic.icon}" class="w-4 h-4"></i></div>
                    <div class="flex-1"><span class="text-sm font-bold flex items-center gap-1">${lic.short} ${lic.isEdu && !isActive ? '<span class="opacity-0 group-hover:opacity-100 transition-opacity">ğŸ“</span>' : ''}</span></div>
                </button>`;
            };

            const html = `
                <div>
                    <div class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 px-2">å•†æ¥­èˆ‡æ”¿åºœ</div>
                    <div class="space-y-1">${commGovLics.map(renderBtn).join('')}</div>
                </div>
                <div>
                    <div class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 px-2 mt-6">æ•™è‚²å–®ä½ (Education)</div>
                    <div class="space-y-1">${eduLics.map(renderBtn).join('')}</div>
                </div>
            `;
            document.getElementById('sidebar-menu').innerHTML = html;
        }

        function renderMainContent() {
            const lic = getActiveLic();
            const isRestricted = lic.type === 'restricted';
            const displayApps = getFilteredApps();

            const desktopApps = displayApps.filter(a => a.category === 'desktop');
            const substanceApps = displayApps.filter(a => a.category === 'substance');
            const cloudApps = displayApps.filter(a => a.category === 'cloud' || a.category === 'mobile'); 
            const eolApps = displayApps.filter(a => a.category === 'eol');

            // --- Logic Adjustments ---
            if (!lic.isEdu && state.tenderLevel === 'substance') {
                state.tenderLevel = 'flagship'; // reset if invalid
            }

            const level = state.tenderLevel;
            const summary = level === 'flagship' ? lic.summaryFlagship : level === 'essential' ? lic.summaryEssential : lic.summarySubstance;
            
            // --- Templates ---
            
            // 1. Header & Controls
            const headerHtml = `
                <div class="flex flex-col xl:flex-row xl:items-center justify-between gap-4">
                    <div>
                        <h1 class="text-2xl font-bold text-slate-900 flex items-center gap-2">${lic.name}</h1>
                        <p class="text-slate-500 text-sm mt-1">${isRestricted ? 'âš ï¸ é™åˆ¶å‹æˆæ¬Šï¼šåƒ…åŒ…å«æ¡Œé¢ç«¯è»Ÿé«”ï¼Œå·²è‡ªå‹•éæ¿¾ä¸é©ç”¨é …ç›®ã€‚' : 'âœ… å®Œæ•´å‹æˆæ¬Šï¼šåŒ…å«æ¡Œé¢ã€è¡Œå‹•è£ç½®èˆ‡é›²ç«¯æœå‹™ã€‚'}</p>
                    </div>
                    <div class="flex flex-wrap items-center gap-3">
                        <div class="flex bg-slate-100 p-1 rounded-lg border border-slate-200 w-full sm:w-auto overflow-x-auto">
                            <button onclick="setTenderLevel('flagship')" class="flex-1 sm:flex-none whitespace-nowrap flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-bold transition-all ${level === 'flagship' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}"><i data-lucide="clapperboard" class="w-3.5 h-3.5"></i> å…¨å¥—æ——è‰¦</button>
                            <button onclick="setTenderLevel('essential')" class="flex-1 sm:flex-none whitespace-nowrap flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-bold transition-all ${level === 'essential' ? 'bg-white text-emerald-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}"><i data-lucide="pen-tool" class="w-3.5 h-3.5"></i> åŸºç¤å¹³é¢</button>
                            ${lic.isEdu && lic.id !== 'gov_frl' ? `<button onclick="setTenderLevel('substance')" class="flex-1 sm:flex-none whitespace-nowrap flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-bold transition-all ${level === 'substance' ? 'bg-white text-amber-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}"><i data-lucide="box" class="w-3.5 h-3.5"></i> Substance å°ˆç”¨</button>` : ''}
                        </div>
                        
                        <div class="flex gap-2 w-full sm:w-auto">
                            <button onclick="toggleAudit()" class="flex-1 sm:flex-none flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-bold border transition-all ${state.isAuditMode ? 'bg-amber-100 text-amber-700 border-amber-300 shadow-inner' : 'bg-white text-slate-500 border-slate-200 hover:bg-slate-50'}">
                                <i data-lucide="${state.isAuditMode ? 'eye' : 'clipboard-check'}" class="w-4 h-4"></i><span class="hidden sm:inline">${state.isAuditMode ? 'é—œé–‰ç¨½æ ¸' : 'è³‡æ–™ç¨½æ ¸'}</span>
                            </button>
                            <button onclick="handleCopy()" class="flex-1 sm:flex-none flex items-center justify-center gap-2 bg-slate-900 hover:bg-slate-800 text-white px-4 py-2.5 rounded-lg shadow-sm transition-all font-medium text-sm">
                                <i data-lucide="${state.copyFeedback ? 'check-circle' : 'copy'}" class="w-4 h-4 ${state.copyFeedback ? 'text-green-400' : ''}"></i> ${state.copyFeedback ? 'å·²è¤‡è£½' : 'è¤‡è£½è¦æ ¼'}
                            </button>
                            <button onclick="handleDownload()" class="flex items-center justify-center gap-2 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 px-4 py-2.5 rounded-lg shadow-sm transition-all font-medium text-sm" title="ä¸‹è¼‰è¦æ ¼æ–‡å­—æª”"><i data-lucide="download" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                </div>
            `;

            // 2. Summary Banner
            let bgClass = level === 'flagship' ? 'bg-gradient-to-r from-violet-600 to-indigo-600' : level === 'essential' ? 'bg-gradient-to-r from-emerald-600 to-teal-600' : 'bg-gradient-to-r from-amber-600 to-orange-600';
            let title = level === 'flagship' ? 'å…¨å¥—æ——è‰¦å®‰è£ãƒ»é«˜éšå½±è¦–é–€æª»' : level === 'essential' ? 'åŸºç¤å¹³é¢å®‰è£ãƒ»ä¸€èˆ¬è¨­è¨ˆé–€æª»' : 'Substance 3D å°ˆç”¨ãƒ»é«˜éš 3D é–€æª»';
            
            const bannerHtml = summary ? `
                <div class="mb-6 rounded-xl p-6 text-white shadow-lg animate-fade-in relative overflow-hidden transition-colors duration-500 ${bgClass}">
                    <div class="absolute top-0 right-0 p-4 opacity-10"><i data-lucide="zap" class="w-24 h-24"></i></div>
                    <div class="relative z-10">
                        <h2 class="text-xl font-bold flex items-center gap-2 mb-4"><i data-lucide="check-circle" class="w-6 h-6 text-white/90"></i> ${title}</h2>
                        
                        <div class="mb-6 bg-black/20 border border-white/20 rounded-lg p-4 flex gap-4 backdrop-blur-md">
                            <div class="bg-rose-500 text-white p-2 rounded-full h-fit flex-shrink-0"><i data-lucide="calendar-clock" class="w-5 h-5"></i></div>
                            <div>
                                <div class="font-bold text-white text-base mb-1">è³‡å®‰é¢¨éšªè²æ˜ (Security Advisory)</div>
                                <p class="text-sm text-white/90 leading-relaxed opacity-90">å¾®è»Ÿå°‡æ–¼ 2025 å¹´ 10 æœˆ 14 æ—¥çµ‚æ­¢ Windows 10 æ”¯æ´ã€‚ç‚ºè³‡å®‰åˆè¦ï¼Œ<a href="https://support.microsoft.com/zh-tw/windows/windows-10-%E6%94%AF%E6%8F%B4%E5%B7%B2%E6%96%BC-2025-%E5%B9%B4-10-%E6%9C%88-14-%E6%97%A5%E7%B5%90%E6%9D%9F-2ca8b313-1946-43d3-b55c-2b95b107f281" target="_blank" class="underline font-bold hover:text-rose-200 ml-1">å¼·çƒˆå»ºè­°æ¡è³¼ Windows 11</a>ã€‚</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-white/10 rounded-lg p-3 border border-white/20 backdrop-blur-sm"><div class="text-xs text-white/70 mb-1 flex items-center gap-1"><i data-lucide="hard-drive" class="w-3 h-3"></i> OS ç³»çµ±</div><div class="font-bold text-lg leading-tight">${summary.os}</div></div>
                            <div class="bg-white/10 rounded-lg p-3 border border-white/20 backdrop-blur-sm"><div class="text-xs text-white/70 mb-1 flex items-center gap-1"><i data-lucide="cpu" class="w-3 h-3"></i> è™•ç†å™¨ CPU</div><div class="font-bold text-lg">${summary.cpu}</div><div class="text-[10px] text-white/60">æ”¯æ´ AVX2</div></div>
                            <div class="bg-white/10 rounded-lg p-3 border border-white/20 backdrop-blur-sm"><div class="text-xs text-white/70 mb-1 flex items-center gap-1"><i data-lucide="layers" class="w-3 h-3"></i> è¨˜æ†¶é«” RAM</div><div class="font-bold text-lg">${summary.ram}</div><div class="text-[10px] text-white/60">${level === 'flagship' ? 'AE/PR å»ºè­°' : 'PS/AI è¶³å¤ '}</div></div>
                            <div class="bg-white/10 rounded-lg p-3 border border-white/20 backdrop-blur-sm"><div class="text-xs text-white/70 mb-1 flex items-center gap-1"><i data-lucide="monitor" class="w-3 h-3"></i> é¡¯ç¤ºå¡ GPU</div><div class="font-bold text-lg">${summary.gpu}</div><div class="text-[10px] text-white/60">${level === 'flagship' ? 'æ”¯æ´ç¡¬é«”åŠ é€Ÿ' : 'åŸºæœ¬é¡¯ç¤º'}</div></div>
                        </div>
                    </div>
                </div>
            ` : '';

            // 3. Tables Rendering Helper
            const renderTable = (title, iconName, apps, colorClass) => {
                if (!apps || apps.length === 0) return '';
                const isDesktopOrSub = title.includes("Desktop") || title.includes("Substance") || title.includes("ç‰¹æ®Š");
                
                const rows = apps.map(app => {
                    const isDimmed = (state.tenderLevel === 'essential' && app.is_heavy) || app.is_eol;
                    const platforms = [];
                    if (app.has_web) platforms.push(`<span class="text-[10px] font-bold bg-sky-100 text-sky-700 px-1.5 py-0.5 rounded border border-sky-200">Web</span>`);
                    if (app.has_ios) platforms.push(`<span class="text-[10px] font-bold bg-indigo-100 text-indigo-700 px-1.5 py-0.5 rounded border border-indigo-200">iOS</span>`);
                    if (app.has_android) platforms.push(`<span class="text-[10px] font-bold bg-green-100 text-green-700 px-1.5 py-0.5 rounded border border-green-200">Android</span>`);
                    
                    const badgeHtml = platforms.length > 0 ? `<div class="flex gap-1 mt-1 flex-wrap">${platforms.join('')}</div>` : `<span class="text-xs text-slate-400 mt-1 block">${app.version}</span>`;

                    return `
                    <tr class="group hover:bg-slate-50 transition-colors ${isDimmed ? 'opacity-50 bg-slate-50 grayscale' : ''}">
                        <td class="px-6 py-4 align-top">
                            <button onclick="openModal('${app.id}')" class="flex items-center gap-3 text-left w-full group-hover:translate-x-1 transition-transform">
                                <div class="flex-shrink-0 p-2 rounded-lg bg-slate-100 text-slate-600"><i data-lucide="${app.icon}" class="w-5 h-5"></i></div>
                                <div>
                                    <div class="font-bold text-slate-900 flex items-center gap-2">
                                        ${app.name}
                                        ${app.is_eol ? '<span class="px-1.5 py-0.5 bg-slate-200 text-slate-600 text-[9px] rounded uppercase">ä¸åˆ—å…¥è¦æ ¼</span>' : ''}
                                    </div>
                                    ${badgeHtml}
                                    ${isDimmed && !app.is_eol ? '<div class="text-[10px] font-bold text-slate-500 mt-1">[éåŸºç¤å®‰è£æ ¸å¿ƒè»Ÿé«”]</div>' : ''}
                                    ${app.alert ? `<div class="mt-1 flex items-center gap-1 text-[10px] font-bold px-1.5 py-0.5 rounded w-fit ${app.is_eol ? 'bg-red-50 text-red-600' : 'bg-amber-50 text-amber-600'}"><i data-lucide="${app.is_eol ? 'x-circle' : 'alert-triangle'}" class="w-3 h-3"></i>${app.alert}</div>` : ''}
                                </div>
                            </button>
                        </td>
                        ${isDesktopOrSub ? `
                            <td class="px-6 py-4 align-top">
                                <div class="font-medium text-slate-700">${app.min_os_win || '-'}</div>
                                ${app.min_os_win !== '-' ? '<div class="text-xs text-slate-400">æœ€ä½æ”¯æ´ç‰ˆæœ¬</div>' : ''}
                            </td>
                            <td class="px-6 py-4 align-top">
                                <div class="font-medium ${app.min_os_mac && app.min_os_mac.includes('ä¸æ”¯æ´') ? 'text-red-500' : 'text-slate-700'}">${app.min_os_mac || '-'}</div>
                                ${app.min_os_mac && app.min_os_mac.includes('14') && !isDimmed ? '<div class="text-[10px] text-amber-600">å»ºè­° Sonoma æœ€ä½³</div>' : ''}
                            </td>
                            <td class="px-6 py-4 align-top">
                                <div class="space-y-1">
                                    <div class="flex justify-between gap-4"><span class="text-slate-400 text-xs">RAM</span><span class="font-medium text-slate-800">${app.rec_ram || '-'}</span></div>
                                    <div class="flex justify-between gap-4"><span class="text-slate-400 text-xs">GPU</span><span class="font-medium text-slate-800">${app.rec_gpu || '-'}</span></div>
                                </div>
                            </td>
                        ` : ''}
                        ${state.isAuditMode ? `
                            <td class="px-6 py-4 align-middle bg-amber-50/30 border-l border-amber-100">
                                <div class="flex flex-col gap-2">
                                    <a href="${app.url}" target="_blank" class="flex items-center gap-1.5 text-xs text-blue-600 hover:underline font-medium"><i data-lucide="external-link" class="w-3 h-3"></i> é–‹å•Ÿå®˜ç¶²æŸ¥è­‰</a>
                                    <label class="flex items-center gap-2 text-xs text-slate-500 cursor-pointer select-none"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500"> å·²ç¢ºèª</label>
                                </div>
                            </td>
                        ` : ''}
                    </tr>
                    `;
                }).join('');

                return `
                <div class="mb-8 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm animate-fade-in transition-all">
                    <div class="flex items-center gap-2 border-b border-slate-200 bg-slate-50 px-6 py-4 font-bold text-slate-800 ${colorClass}"><i data-lucide="${iconName}" class="w-5 h-5"></i>${title}</div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm text-slate-600">
                            <thead class="bg-slate-50 text-xs uppercase text-slate-500">
                                <tr>
                                    <th class="px-6 py-3 min-w-[250px]">è»Ÿé«”åç¨± / ç‰ˆæœ¬ / æ”¯æ´å¹³å°</th>
                                    ${isDesktopOrSub ? `
                                        <th class="px-6 py-3 min-w-[150px]">Windows éœ€æ±‚</th>
                                        <th class="px-6 py-3 min-w-[150px]">macOS éœ€æ±‚</th>
                                        <th class="px-6 py-3 min-w-[200px]">ç¡¬é«”å»ºè­° (RAM / GPU)</th>
                                    ` : ''}
                                    ${state.isAuditMode ? `<th class="px-6 py-3 min-w-[120px] bg-amber-50 text-amber-800 border-l border-amber-100">å®˜æ–¹æº¯æºç¨½æ ¸</th>` : ''}
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100">
                                ${rows}
                            </tbody>
                        </table>
                    </div>
                </div>
                `;
            };

            // 4. Combine Tables
            let tablesHtml = renderTable("æ¡Œé¢è»Ÿé«” (Desktop Apps)", "monitor", desktopApps, "text-blue-700");
            if (substanceApps.length > 0) tablesHtml += renderTable("æ•™è‚²ç‰ˆå°ˆå±¬æ¬Šç›Š (ä¸åŒ…å«Substance 3D Assets)", "boxes", substanceApps, "text-indigo-700 bg-indigo-50");
            if (eolApps.length > 0) tablesHtml += renderTable("ç‰¹æ®Šç‹€æ…‹è»Ÿé«” (EOL / Free)", "alert-octagon", eolApps, "text-slate-600");
            if (cloudApps.length > 0) tablesHtml += renderTable("è¡Œå‹•è£ç½®æ‡‰ç”¨ç¨‹å¼ (Mobile Apps) èˆ‡ ç¶²é æœå‹™", "smartphone", cloudApps, "text-purple-700");
            
            // 5. Hidden Notice
            const hiddenNoticeHtml = isRestricted ? `
                <div class="bg-slate-100 border border-slate-200 rounded-xl p-8 text-center text-slate-500">
                    <div class="mx-auto mb-2 text-slate-400 w-fit"><i data-lucide="cloud-off" class="w-8 h-8"></i></div>
                    <h4 class="font-bold text-slate-700">è¡Œå‹•è£ç½®èˆ‡é›²ç«¯æœå‹™å€å¡Šå·²éš±è—</h4>
                    <p class="text-sm mt-1">ä¾æ“šæ‚¨é¸æ“‡çš„ <strong>${lic.short}</strong> è¦ç¯„ï¼Œä¸åŒ…å« Photoshop for iPadã€Firefly Web ç­‰æœå‹™ã€‚<br/>æ­¤å€å¡Šå·²è‡ªå‹•å¾æŠ•æ¨™è¦æ ¼æ›¸ä¸­ç§»é™¤ã€‚</p>
                </div>
            ` : '';

            // Update DOM
            const container = document.getElementById('main-content');
            container.innerHTML = headerHtml + bannerHtml + tablesHtml + hiddenNoticeHtml;
            
            // Re-run icons
            lucide.createIcons();
        }

        function openModal(appId) {
            const app = adobeApps.find(a => a.id === appId);
            if (!app) return;
            
            const modalHtml = `
            <div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in" onclick="closeModal()">
                <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 relative border border-slate-100" onclick="event.stopPropagation()">
                    <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 transition-colors"><i data-lucide="x" class="w-5 h-5"></i></button>
                    <div class="flex flex-col items-center text-center">
                        <div class="p-4 rounded-2xl mb-4 ${app.category === 'desktop' ? 'bg-blue-50 text-blue-600' : app.category === 'mobile' ? 'bg-purple-50 text-purple-600' : app.category === 'substance' ? 'bg-indigo-50 text-indigo-600' : 'bg-slate-100 text-slate-500'}">
                            <i data-lucide="${app.icon}" class="w-12 h-12"></i>
                        </div>
                        <h3 class="text-xl font-bold text-slate-900 mb-1">${app.name}</h3>
                        <p class="text-sm text-slate-500 font-medium mb-4">${app.category.toUpperCase()} â€¢ ${app.version}</p>
                        <div class="bg-slate-50 rounded-xl p-4 text-sm text-slate-600 leading-relaxed w-full text-left border border-slate-100">
                            ${app.intro || app.desc}
                        </div>
                        <a href="${app.url}" target="_blank" class="mt-6 flex items-center justify-center gap-2 w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-slate-800 transition-all">å‰å¾€å®˜æ–¹è¦æ ¼é  <i data-lucide="external-link" class="w-4 h-4"></i></a>
                    </div>
                </div>
            </div>
            `;
            document.getElementById('modal-container').innerHTML = modalHtml;
            lucide.createIcons();
        }

        function closeModal() {
            document.getElementById('modal-container').innerHTML = '';
        }

        // --- INTERACTION ---

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar-container');
            const overlay = document.getElementById('mobile-overlay');
            const isOpen = !sidebar.classList.contains('-translate-x-full');
            
            if (isOpen) {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            } else {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            }
        }

        function changeLicense(id) {
            state.activeLicId = id;
            state.tenderLevel = 'flagship'; // reset default
            // close sidebar on mobile if open
            const sidebar = document.getElementById('sidebar-container');
            if (!sidebar.classList.contains('-translate-x-full') && window.innerWidth < 1024) {
                toggleSidebar();
            }
            renderSidebar();
            renderMainContent();
        }

        function setTenderLevel(level) {
            state.tenderLevel = level;
            renderMainContent();
        }

        function toggleAudit() {
            state.isAuditMode = !state.isAuditMode;
            renderMainContent();
        }

        function getTenderText() {
            const lic = getActiveLic();
            const isRestricted = lic.type === 'restricted';
            const apps = getFilteredApps();
            const level = state.tenderLevel;
            const summary = level === 'flagship' ? lic.summaryFlagship : level === 'essential' ? lic.summaryEssential : lic.summarySubstance;
            
            const desktopAppsList = apps.filter(a => a.category === 'desktop').map(a => `${a.name}${a.alert ? ` (${a.alert})` : ''}`).join('\n   - ');
            const substanceAppsList = apps.filter(a => a.category === 'substance').map(a => a.name).join(', ');
            const mobileAppsList = apps.filter(a => a.category === 'cloud').map(a => {
                let platforms = [];
                if (a.has_web) platforms.push('Web');
                if (a.has_ios) platforms.push('iOS');
                if (a.has_android) platforms.push('Android');
                return `${a.name} [${platforms.join('/')}]`;
            }).join('\n   - ');
            const eolAppsList = apps.filter(a => a.category === 'eol').map(a => `${a.name}: ${a.alert}`).join('\n   - ');

            let text = `ã€Adobe CC 2026 (v26) ç¡¬é«”æ¡è³¼è¦æ ¼æ›¸ - ${lic.name}ã€‘\næ¡è³¼ç­‰ç´šï¼š${level === 'flagship' ? 'å…¨å¥—æ——è‰¦è¦æ ¼' : level === 'essential' ? 'åŸºç¤å¹³é¢è¦æ ¼' : 'Substance 3D å°ˆç”¨'}\nè³‡æ–™ä¾†æºï¼šAdobe å®˜æ–¹ç¶²ç«™ (HelpX) - 2025/2026 Release\n\nã€è³‡å®‰é¢¨éšªè²æ˜ (Security Advisory)ã€‘\nå¾®è»Ÿå°‡æ–¼ 2025 å¹´ 10 æœˆ 14 æ—¥çµ‚æ­¢ Windows 10 æ”¯æ´ã€‚\nç‚ºè³‡å®‰åˆè¦ï¼Œå¼·çƒˆå»ºè­°æ¡è³¼ Windows 11ã€‚\nåƒè€ƒé€£çµï¼šhttps://support.microsoft.com/zh-tw/windows/windows-10-%E6%94%AF%E6%8F%B4%E5%B7%B2%E6%96%BC-2025-%E5%B9%B4-10-%E6%9C%88-14-%E6%97%A5%E7%B5%90%E6%9D%9F-2ca8b313-1946-43d3-b55c-2b95b107f281\n\nã€ç¡¬é«”è¦æ ¼ç¸½çµã€‘\nâ— ä½œæ¥­ç³»çµ±ï¼šWindows 11 (å»ºè­°) / Windows 10 22H2 (æœ€ä½)\nâ— è™•ç†å™¨ (CPU)ï¼š${summary?.cpu || '-'} ${level === 'essential' ? '' : '(éœ€æ”¯æ´ AVX2 æŒ‡ä»¤é›†)'}\nâ— è¨˜æ†¶é«” (RAM)ï¼š${summary?.ram || '-'}\nâ— é¡¯ç¤ºå¡ (GPU)ï¼š${summary?.gpu || '-'}\n\n=== è»Ÿé«”æˆæ¬Šæ¸…å–® (æ¡Œé¢ç«¯) ===\næœ¬æ¡ˆæ¡è³¼åŒ…å« Adobe Creative Cloud å…¨å¥—æˆæ¬Šï¼Œæ¡Œé¢è»Ÿé«”æ¸…å–®å¦‚ä¸‹ï¼š\n   - ${desktopAppsList}\n`;

            if (substanceAppsList.length > 0) text += `\n=== æ•™è‚²ç‰ˆå°ˆå±¬æ¬Šç›Š (ä¸åŒ…å«Substance 3D Assets) ===\næœ¬æˆæ¬Šæ–¹æ¡ˆåŒ…å«ä»¥ä¸‹ 3D å‰µä½œè»Ÿé«”ï¼š\n   - ${substanceAppsList}\n`;
            
            text += `\n=== ç‰¹åˆ¥è¨»è¨˜è»Ÿé«” (ä¸åˆ—å…¥è¦æ ¼è¨ˆç®—) ===\nä»¥ä¸‹è»Ÿé«”é›–åŒ…å«æ–¼æˆæ¬Šä¸­ (éƒ¨åˆ†ä¾‹å¤–)ï¼Œä½†å› ç‹€æ…‹ç‰¹æ®Šï¼Œä¸åˆ—å…¥ç¡¬é«”æ•ˆèƒ½è©•ä¼°ï¼š\n   - ${eolAppsList}\n`;
            
            if (!isRestricted) {
                text += `\n=== è¡Œå‹•è£ç½®æ‡‰ç”¨ç¨‹å¼ (Mobile Apps) èˆ‡ ç¶²é æœå‹™ ===\nåŒ…å«ä»¥ä¸‹é …ç›® (éœ€å…·å‚™ Adobe ID ç™»å…¥æ¬Šé™)ï¼š\n   - ${mobileAppsList}\n`;
            } else {
                text += `\nâ˜… æ’é™¤é …ç›®å®£å‘Š (SDL/FRL é™åˆ¶):\n- æœ¬æ¡ˆæ¡è³¼ä¹‹æˆæ¬Šç‚ºã€${lic.name}ã€‘ï¼Œä¸åŒ…å«è¡Œå‹•è£ç½® App èˆ‡é›²ç«¯æœå‹™ã€‚\n`;
            }
            return text;
        }

        function handleCopy() {
            const text = getTenderText();
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                state.copyFeedback = true;
                renderMainContent();
                setTimeout(() => {
                    state.copyFeedback = false;
                    renderMainContent(); // re-render to reset button
                }, 2000);
            } catch (err) {
                console.error(err);
            }
            document.body.removeChild(textArea);
        }

        function handleDownload() {
            const lic = getActiveLic();
            const text = getTenderText();
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Adobe_Spec_${lic.short}_${state.tenderLevel}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // --- INIT ---
        window.onload = function() {
            renderSidebar();
            renderMainContent();
        };

    </script>
</body>
</html>
